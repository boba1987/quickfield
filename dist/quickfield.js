var slice=[].slice;
(function(ra){return function(){var I;I=function(I,F,N,Q){Q=function(e){return N[e]?F[e]:(N[e]=1,F[e]={},F[e]=I[e](F[e]))};I[3]=function(e){var p={exports:e},r=[].slice;(function(){var e;e=function(e){return function(e){var g,p,t,d,l;p=function(d){var e,A,g;e=function(d){return Array.isArray(d)};A=function(d){return d&&"[object Object]"===Object.prototype.toString.call(d)||e(d)};g=function(d,k){return k.notDeep?-1!==k.notDeep.indexOf(d):!1};return d=p=function(d,k,r){var C,l,t,b,a,c;if(!k||"object"!==
typeof k&&"function"!==typeof k)k={};C=0;for(t=r.length;C<t;C++)if(b=r[C],null!=b)for(l in b)if(a=b[l],c=k[l],!(a===k||void 0===a||null===a&&!d.allowNull||d.keys&&-1===d.keys.indexOf(l)||d.notKeys&&-1!==d.notKeys.indexOf(l)||d.own&&!b.hasOwnProperty(l)||d.globalFilter&&!d.globalFilter(a,l,b)||d.filters&&d.filters[l]&&!d.filters[l](a,l,b)))switch(d.globalTransform&&(a=d.globalTransform(a,l,b)),d.transforms&&d.transforms[l]&&(a=d.transforms[l](a,l,b)),!1){case !(d.concat&&e(a)&&e(c)):k[l]=c.concat(a);
break;case !(d.deep&&A(a)&&!g(l,d)):c=A(c)?c:e(a)?[]:{};k[l]=p(d,c,[a]);break;default:k[l]=a}return k}}({});l=function(d){var e,g,A;g={};for(e in d)A=d[e],g[e]=A;return g};d=function(d){if(d)return"object"!==typeof d||Array.isArray(d)?[].concat(d):Object.keys(d)};g=function(d){var e;e=d.target?function(){var d;d=1<=arguments.length?r.call(arguments,0):[];return p(e.options,e.options.target,d)}:function(){var d,g;g=arguments[0];d=2<=arguments.length?r.call(arguments,1):[];return p(e.options,g,d)};
e.options=d;Object.defineProperties(e,t);return e};t={deep:{get:function(){var d;d=l(this.options);d.deep=!0;return g(d)}},own:{get:function(){var d;d=l(this.options);d.own=!0;return g(d)}},allowNull:{get:function(){var d;d=l(this.options);d.allowNull=!0;return g(d)}},concat:{get:function(){var d;d=l(this.options);d.concat=!0;return g(d)}},clone:{get:function(){var d;d=l(this.options);d.target={};return g(d)}},notDeep:{get:function(){var e;e=l(this.options);return function(r){e.notDeep=d(r);return g(e)}}},
keys:{get:function(){var e;e=l(this.options);return function(r){e.keys=d(r);return g(e)}}},notKeys:{get:function(){var e;e=l(this.options);return function(r){e.notKeys=d(r);return g(e)}}},transform:{get:function(){var d;d=l(this.options);return function(e){"function"===typeof e?d.globalTransform=e:e&&"object"===typeof e&&(d.transforms=e);return g(d)}}},filter:{get:function(){var d;d=l(this.options);return function(e){"function"===typeof e?d.globalFilter=e:e&&"object"===typeof e&&(d.filters=e);return g(d)}}}};
return e=g({})}}(this)({});null!=("undefined"!==typeof p&&null!==p?p.exports:void 0)?p.exports=e:"function"===typeof define&&define.amd?define(["smart-extend"],function(){return e}):window.extend=e})();return p.exports};I[4]=function(e){var p;return p=e={defined:function(e){return void 0!==e},array:function(e){return e instanceof Array},object:function(e){return"object"===typeof e&&e},objectPlain:function(e){return p.object(e)&&"[object Object]"===Object.prototype.toString.call(e)},string:function(e){return"string"===
typeof e},number:function(e){return"number"===typeof e},"function":function(e){return"function"===typeof e},iterable:function(e){return p.object(e)&&p.number(e.length)}}};return Q};I=I({},{},{});return function(){var X,F,N,Q,e,p,r,g,O,G,S,z,t,d,l,A,C,Y,x,T,k,Z,U,J,L;e=function(b){return function(a){var b={exports:a};(function(){var a,c,d,e,h,k,g,l,p,y,r,t,z,B,x,A,E,C,G,F,K;a=function(a){var b={exports:a};(function(){var a,c,n,v,d,f,e,m;v=["webkit","moz","ms","o"];f="backgroundPositionX backgroundPositionY blockSize borderWidth columnRuleWidth cx cy fontSize gridColumnGap gridRowGap height inlineSize lineHeight minBlockSize minHeight minInlineSize minWidth maxHeight maxWidth outlineOffset outlineWidth perspective shapeMargin strokeDashoffset strokeWidth textIndent width wordSpacing top bottom left right x y".split(" ");
["margin","padding","border","borderRadius"].forEach(function(a){var b,c,n,v,d;f.push(a);v=["Top","Bottom","Left","Right"];d=[];c=0;for(n=v.length;c<n;c++)b=v[c],d.push(f.push(a+b));return d});m=document.createElement("div").style;a=/^\d+(?:[a-z]|\%)+$/i;c=/\d+$/;n=/\s/;e={includes:function(a,b){return a&&-1!==a.indexOf(b)},isIterable:function(a){return a&&"object"===typeof a&&"number"===typeof a.length&&!a.nodeType},isPropSupported:function(a){return"undefined"!==typeof m[a]},toTitleCase:function(a){return a[0].toUpperCase()+
a.slice(1)},normalizeProperty:function(a){var b,c,n;if(this.isPropSupported(a))return a;n=this.toTitleCase(a);a=0;for(b=v.length;a<b;a++)if(c=v[a],c=""+c+n,this.isPropSupported(c))return c},normalizeValue:function(b,v){this.includes(f,b)&&null!==v&&(v=""+v,!c.test(v)||a.test(v)||n.test(v)||(v+="px"));return v}};d=function(a,b,c){var n,v,f;if(e.isIterable(a))for(n=0,v=a.length;n<v;n++)f=a[n],d(f,b,c);else if("object"===typeof b)for(n in b)c=b[n],d(a,n,c);else{b=e.normalizeProperty(b);if("undefined"===
typeof c)return getComputedStyle(a)[b];b&&(a.style[b]=e.normalizeValue(b,c))}};d.version="1.0.5";return null!=("undefined"!==typeof b&&null!==b?b.exports:void 0)?b.exports=d:"function"===typeof define&&define.amd?define(["quickdom"],function(){return d}):this.Css=d})();return b.exports}.call(this,{});y=I(3);l="className href selected type name id checked".split(" ");B={includes:function(a,b){return a&&-1!==a.indexOf(b)},removeItem:function(a,b){var c;c=a.indexOf(b);-1!==c&&a.splice(c,1);return a},
normalizeGivenEl:function(a){switch(!1){case !c.domNode(a):return e(a);case !c.string(a):return e.text(a);default:return a}}};c=I(4);c=y.clone(c,{domDoc:function(a){return a&&9===a.nodeType},domEl:function(a){return a&&1===a.nodeType},domText:function(a){return a&&3===a.nodeType},domNode:function(a){return c.domEl(a)||c.domText(a)},quickDomEl:function(a){return a instanceof h},template:function(a){return a instanceof k}});h=function(a,b){this.type=a;this.options=b;this.el=this.options.existing||("text"===
this.type?document.createTextNode(this.options.text):"*"===this.type[0]?document.createElementNS("http://www.w3.org/2000/svg",this.type.slice(1)):document.createElement(this.type));"text"===this.type&&(this.append=this.prepend=this.attr=function(){});this._parent=null;this._state=[];this._children=[];this._childRefs={};this._insertedCallbacks=[];this._eventCallbacks={__refs:{}};this._normalizeOptions();this._applyOptions();this._attachStateEvents();return this.el._quickElement=this};Object.defineProperties(h.prototype,
{raw:{get:function(){return this.el}},0:{get:function(){return this.el}},css:{get:function(){return this.style}},replaceWith:{get:function(){return this.replace}}});h.prototype.parentsUntil=function(a){return z(this,a)};h.prototype.parentMatching=function(a){var b;if(c["function"](a))for(b=this.parent;b;){if(a(b))return b;b=b.parent}};Object.defineProperties(h.prototype,{children:{get:function(){var a,b,c,d;if(this.el.childNodes.length!==this._children.length)for(this._children.length=0,d=this.el.childNodes,
b=0,c=d.length;b<c;b++)a=d[b],4>a.nodeType&&this._children.push(e(a));return this._children}},parent:{get:function(){this._parent&&this._parent.el===this.el.parentNode||c.domDoc(this.el.parentNode)||(this._parent=e(this.el.parentNode));return this._parent}},parents:{get:function(){return z(this)}},next:{get:function(){return e(this.el.nextSibling)}},prev:{get:function(){return e(this.el.previousSibling)}},nextAll:{get:function(){var a,b;b=[];for(a=e(this.el.nextSibling);a;)b.push(a),a=a.next;return b}},
prevAll:{get:function(){var a,b;b=[];for(a=e(this.el.previousSibling);a;)b.push(a),a=a.prev;return b}},siblings:{get:function(){return this.prevAll.reverse().concat(this.nextAll)}}});z=function(a,b){var n,d;c["function"](b)||(b=void 0);d=[];for(n=a.parent;n;)d.push(n),n=n.parent,b&&b(n)&&(n=null);return d};h.prototype._normalizeOptions=function(){var a;null==(a=this.options).style&&(a.style={});this.options.styleShared={};this.options["class"]&&(this.options.className=this.options["class"]);this.options.url&&
(this.options.href=this.options.url);null==(a=this.options).relatedInstance&&(a.relatedInstance=this);null==(a=this.options).unpassableStates&&(a.unpassableStates=[]);null==(a=this.options).passStateToChildren&&(a.passStateToChildren=!0);this.options.stateTriggers=y.deep({hover:{on:"mouseenter",off:"mouseleave"},focus:{on:"focus",off:"blur"}},this.options.stateTriggers);this._normalizeStyle();return this};h.prototype._normalizeStyle=function(){var a,b,c,d,f;b=Object.keys(this.options.style);c=b.filter(function(a){return"$"===
a[0]});d=B.removeItem(c.slice(),"$base");this.providedStates=c.map(function(a){return a.slice(1)});!B.includes(c,"$base")&&b.length&&(c.length?(b=b.filter(function(a){return"$"!==a[0]}),this.options.style.$base=y.clone.keys(b)(this.options.style)):this.options.style={$base:this.options.style});a=function(b){return function(c,n){var d,f,v,e,m,u,h;f=Object.keys(c).filter(function(a){return"$"===a[0]});if(f.length){b.hasSharedStateStyle=!0;null==b._stateShared&&(b._stateShared=[]);m=[];v=0;for(e=f.length;v<
e;v++)d=f[v],u=n.concat(d.slice(1)),h=u.join("+"),b.options.styleShared[h]=b.options.style["$"+h]=c[d],a(c[d],u),m.push(delete c[d]);return m}}}(this);b=0;for(c=d.length;b<c;b++)f=d[b],a(this.options.style[f],[f.slice(1)]);return this};h.prototype._applyOptions=function(){var a,b,c,d;(c=this.options.id||this.options.ref)&&this.attr("data-ref",this.ref=c);this.options.id&&(this.el.id=this.options.id);this.options.className&&(this.el.className=this.options.className);this.options.href&&(this.el.href=
this.options.href);this.options.type&&(this.el.type=this.options.type);this.options.name&&(this.el.name=this.options.name);this.options.value&&(this.el.value=this.options.value);this.options.selected&&(this.el.selected=this.options.selected);this.options.checked&&(this.el.checked=this.options.checked);if(this.options.props)for(b in d=this.options.props,d)c=d[b],this.prop(b,c);if(this.options.attrs)for(b in d=this.options.attrs,d)c=d[b],this.attr(b,c);if(this.options.styleAfterInsert)this.onInserted(a=
function(b){return function(){var c;c=b.parents.slice(-1)[0];return c.raw===document.documentElement?b.style(y.clone.apply(y,[b.options.style.$base].concat(slice.call(b._getStateStyles(b._getActiveStates()))))):c.onInserted(a)}}(this));else this.style(this.options.style.$base);Object.defineProperty(this,"_parent",{set:function(a){var b,c,n;if(a)for(delete this._parent,this._parent=a,n=this._insertedCallbacks,b=0,c=n.length;b<c;b++)a=n[b],a(this)}});return this};h.prototype._attachStateEvents=function(){var a,
b,d,f;b=this.options.stateTriggers;a=function(a){return function(b,n){var d,f;f=c.string(n)?n:n.on;c.object(n)&&(d=n.off);a._listenTo(f,function(){return a.state(b,!0)});if(d)return a._listenTo(d,function(){return a.state(b,!1)})}}(this);for(d in b)f=b[d],a(d,f);return this};G=/\s+/;h.prototype.on=function(a,b){var n,d;c.string(a)&&c["function"](b)&&(d=a.split("."),n=d[1],a=d[0],a.split(G).forEach(function(a){return function(c){a._eventCallbacks[c]||(a._eventCallbacks[c]=[],a._listenTo(c,function(b){var n,
d,f,v;v=a._eventCallbacks[c];d=0;for(f=v.length;d<f;d++)n=v[d],n.call(a.el,b)}));n&&(a._eventCallbacks.__refs[n]=b);return a._eventCallbacks[c].push(b)}}(this)));return this};h.prototype.off=function(a,b){var n,d;if(c.string(a))d=a.split("."),n=d[1],a=d[0],a.split(G).forEach(function(a){return function(d){if(a._eventCallbacks[d]){null==b&&(b=a._eventCallbacks.__refs[n]);if(c["function"](b))return B.removeItem(a._eventCallbacks[d],b);if(!n)return a._eventCallbacks[d].length=0}}}(this));else for(d in this._eventCallbacks)this.off(d);
return this};h.prototype.emit=function(a,b,d){var n;null==b&&(b=!0);null==d&&(d=!0);a&&c.string(a)&&(n=document.createEvent("Event"),n.initEvent(a,b,d),this.el.dispatchEvent(n));return this};h.prototype.onInserted=function(a,b){null==b&&(b=!0);if(c["function"](a))return this._parent?b&&a(this):this._insertedCallbacks.push(a),this};h.prototype._listenTo=function(a,b){this.el[this.el.addEventListener?"addEventListener":"attachEvent"](this.el.addEventListener?a:"on"+a,b);return this};h.prototype.updateOptions=
function(a){c.object(a)&&(this.options=a,this._normalizeOptions(),this._applyOptions(this.options));return this};h.prototype.state=function(a,b,d){var n,f,e,v,m,h,w,M,k;if(1===arguments.length)return B.includes(this._state,a);if(this._statePipeTarget&&d!==this)return this._statePipeTarget.state(a,b,this),this;if(c.string(a)){"$"===a[0]&&(a=a.slice(1));e=!!b;if("base"===a)return this;f=this._getActiveStates(a,!1);n=this._getStateStyles(f);this.state(a)!==e&&(this.options.style["$"+a]&&(m=this.options.style["$"+
a],k=this.providedStates.indexOf(a),f=f.filter(function(a){return function(b){return a.providedStates.indexOf(b)>k}}(this)),h=this._getStateStyles(f)),e?(this._state.push(a),m&&this.style(y.clone.keys(m).apply(null,[m].concat(slice.call(h))))):(B.removeItem(this._state,a),m&&(v=y.clone.keys(m).apply(null,[this.options.style.$base].concat(slice.call(n))),m=y.transform(function(){return null}).clone(m),this.style(y(m,v)))));if(this.hasSharedStateStyle)for(w=Object.keys(this.options.styleShared),w=w.filter(function(b){return B.includes(b,
a)}),f=0,h=w.length;f<h;f++)if(M=w[f],v=M.split("+"),m=v.length===v.filter(function(b){return function(c){return c===a||b.state(c)}}(this)).length)m=this.options.styleShared[M],e?(B.includes(this._stateShared,M)||this._stateShared.push(M),v=this.options.styleShared[B.removeItem(v,a).join("+")],this.style(y.clone(v,m))):(B.removeItem(this._stateShared,M),v=y.clone.keys(m).apply(null,[this.options.style.$base].concat(slice.call(n))),m=y.transform(function(){return null}).clone(m),this.style(y(m,v)));
if(this.options.passStateToChildren&&!B.includes(this.options.unpassableStates,a))for(f=this._children,e=0,m=f.length;e<m;e++)n=f[e],n.state(a,b,d||this);return this}};h.prototype.resetState=function(){var a,b,c,d;d=this._state.slice();b=0;for(c=d.length;b<c;b++)a=d[b],this.state(a,!1);return this};h.prototype.pipeState=function(a){var b,n,d,f;if(a){if(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a!==this)for(this._statePipeTarget=a,f=this._state,n=0,d=f.length;n<d;n++)b=f[n],a.state(b,!0)}else!1===a&&
delete this._statePipeTarget;return this};h.prototype.style=function(){var b,d;if("text"!==this.type){b=arguments;if(c.string(b[0])){if(d=a(this.el,b[0],b[1]),!c.defined(b[1]))return d}else c.object(b[0])&&a(this.el,y.allowNull.transform(function(a){return function(b){return"function"===typeof b?b.call(a,a.options.relatedInstance):b}}(this)).clone(b[0]));return this}};h.prototype.styleSafe=function(a,b){var n,d;if("text"!==this.type)return n=arguments,d=this.style(a),c.string(d)?(b&&(d=0),d||this.el.style[n[0]]||
this.options.style.$base[n[0]]||""):this};h.prototype._getActiveStates=function(a,b){var c;null==b&&(b=!0);c=this.providedStates.filter(function(b){return function(c){return B.includes(b._state,c)&&c!==a}}(this));return b&&this.hasSharedStateStyle?c.concat(this._stateShared):c};h.prototype._getStateStyles=function(a){return a.map(function(a){return function(b){return a.options.style["$"+b]}}(this))};Object.defineProperty(h.prototype,"rect",{get:function(){return this.el.getBoundingClientRect()}});
h.prototype.attr=function(a,b){switch(b){case void 0:return this.el.getAttribute(a);case null:return this.el.removeAttribute(a);default:return this.el.setAttribute(a,b),this}};h.prototype.prop=function(a,b){switch(b){case void 0:return this.el[a];default:return this.el[a]=b,this}};h.prototype.toTemplate=function(){return e.template(this)};h.prototype.clone=function(){var a,b,c,d,f,e,m;c=this.el.cloneNode(!1);c=y.clone(this.options,{existing:c});c=new h(this.type,c);e=this._state;b=0;for(f=e.length;b<
f;b++)a=e[b],c.state(a,!0);e=this.children;b=0;for(f=e.length;b<f;b++)a=e[b],c.append(a.clone());m=this._eventCallbacks;for(d in m)for(b=m[d],e=0,f=b.length;e<f;e++)a=b[e],c.on(d,a);return c};h.prototype.append=function(a){var b;a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&((b=a.parent)&&b._removeChild(a),this._children.push(a),this.el.appendChild(a.el),a.parent));return this};h.prototype.appendTo=function(a){a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a.append(this));return this};h.prototype.prepend=
function(a){var b;a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&((b=a.parent)&&b._removeChild(a),this._children.unshift(a),this.el.insertBefore(a.el,this.el.firstChild),a.parent));return this};h.prototype.prependTo=function(a){a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a.prepend(this));return this};h.prototype.html=function(a){if(!c.defined(a))return this.el.innerHTML;this.el.innerHTML=a;return this};h.prototype.text=function(a){if(!c.defined(a))return this.el.textContent;this.el.textContent=a;return this};
h.prototype.after=function(a){var b;a&&this.parent&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&(b=this.parent._children.indexOf(this),this.parent._children.splice(b+1,0,a),this.el.parentNode.insertBefore(a.el,this.el.nextSibling),a.parent));return this};h.prototype.insertAfter=function(a){a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a.after(this));return this};h.prototype.before=function(a){var b;a&&this.parent&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&(b=this.parent._children.indexOf(this),this.parent._children.splice(b,
0,a),this.el.parentNode.insertBefore(a.el,this.el),a.parent));return this};h.prototype.insertBefore=function(a){a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a.before(this));return this};h.prototype.detach=function(){var a;null!=(a=this.parent)&&a._removeChild(this);return this};h.prototype.remove=function(){var a;this.detach();this.resetState();for(a in this._eventCallbacks)this._eventCallbacks[a].length=0;return this};h.prototype.empty=function(){var a,b,c,d;d=this.children.slice();b=0;for(c=d.length;b<
c;b++)a=d[b],this._removeChild(a);return this};h.prototype.wrap=function(a){var b;a&&(a=B.normalizeGivenEl(a),b=this.parent,c.quickDomEl(a)&&a!==this&&a!==this.parent&&(b&&b._removeChild(this,a.parent?void 0:a),a.append(this)));return this};h.prototype.unwrap=function(){var a,b,c,d;if(b=this.parent)if(c=e.batch(b.children),d=b.next,a=b.parent)b.detach(),d?c.insertBefore(d):c.appendTo(a);return this};h.prototype.replace=function(a){var b;a&&(a=B.normalizeGivenEl(a),c.quickDomEl(a)&&a!==this&&(a.detach(),
null!=(b=this.parent)&&b._removeChild(this,a)));return this};h.prototype._removeChild=function(a,b){var c;c=this._children.indexOf(a);-1!==c&&(b?(this.el.replaceChild(b.el,a.el),this._children.splice(c,1,b)):(this.el.removeChild(a.el),this._children.splice(c,1)));return this};g={type:"window",el:window,raw:window,_eventCallbacks:{__refs:{}}};g.on=h.prototype.on;g.off=h.prototype.off;g.emit=h.prototype.emit;g._listenTo=h.prototype._listenTo;e=function(){var a,b,d,f,m;a=1<=arguments.length?slice.call(arguments,
0):[];switch(!1){case !c.template(a[0]):return a[0].spawn();case !c.quickDomEl(a[0]):return a[1]?a[0].updateOptions(a[1]):a[0];case !(c.domNode(a[0])||c.domDoc(a[0])):if(a[0]._quickElement)return a[0]._quickElement;d=a[0].nodeName.toLowerCase().replace("#","");b=a[1]||{};b.existing=a[0];return new h(d,b);case a[0]!==window:return g;case !c.string(a[0]):d=a[0].toLowerCase();b="text"===d?c.object(a[1])?a[1]:{text:a[1]||""}:c.object(a[1])?a[1]:{};a=a.slice(2);d=new h(d,b);f=0;for(m=a.length;f<m;f++)b=
a[f],c.string(b)&&(b=e.text(b)),c.template(b)&&(b=e(b)),c.quickDomEl(b)&&b.appendTo(d);return d}};e.template=function(a){return new k(a,!0)};d=function(a,b){this.elements=a;this.returnResults=b;this.elements=this.elements.map(function(a){return e(a)});return this};d.prototype.reverse=function(){this.elements=this.elements.reverse();return this};d.prototype["return"]=function(a){return a?(this.returnResults=!0,this):this.lastResults};Object.keys(h.prototype).concat("css","replaceWith").forEach(function(a){return d.prototype[a]=
function(){var b,c;c=this.lastResults=function(){var c,d,f,e;f=this.elements;e=[];c=0;for(d=f.length;c<d;c++)b=f[c],e.push(b[a].apply(b,arguments));return e}.apply(this,arguments);return this.returnResults?c:this}});e.batch=function(a,b){if(!c.iterable(a))throw Error("Batch: expected an iterable, got "+String(a));if(!a.length)throw Error("Batch: expected a non-empty element collection");return new d(a,b)};p={type:"div",options:{},children:[]};k=function(a,b){this._config=b?C(a):a;return this};Object.keys(p).forEach(function(a){return Object.defineProperty(k.prototype,
a,{get:function(){return this._config[a]}})});k.prototype.spawn=function(a,b){var c;c=r(this._config,a,b);return e.apply(null,[c.type,c.options].concat(slice.call(c.children)))};k.prototype.extend=function(a,b){return new k(r(this._config,a,b))};r=function(a,b,d){var f,e,m,h,n;d&&(f={options:function(a){return y(a,d)}});c.array(b)&&(b=C(b,!1));f=y.deep.notKeys("children").notDeep("relatedInstance").transform(f).clone(a,b);a=a.children||[];h=(null!=b?b.children:void 0)||[];f.children=[];e=m=0;for(n=
Math.max(a.length,h.length);0<=n?m<n:m>n;e=0<=n?++m:--m)b=a[e],e=h[e],c.array(e)&&(e=C(e,!1)),c.string(e)&&(e={type:"text",options:{text:e}}),b?f.children.push(b.extend(e,d)):f.children.push(new k(y.deep.clone(p,e)));return f};C=function(a,b){var d;switch(!1){case !c.array(a):d={};if(c.string(a[0]))d.type=a[0];else throw Error(E+" string for 'type', got '"+String(a[0])+"'");if(1<a.length&&!c.object(a[1])&&null!==a[1])throw Error(E+" object for 'options', got '"+String(a[1])+"'");d.options=a[1]?y.deep.clone(a[1]):
null;d.children=a.slice(2);!1!==b&&(d.children=d.children.map(e.template));return d;case !(c.string(a)||c.domText(a)):return{type:"text",options:{text:a.textContent||a}};case !c.domEl(a):return{type:a.nodeName.toLowerCase(),options:y.clone.keys(l)(a),children:[].map.call(a.childNodes,e.template)};case !c.quickDomEl(a):return{type:a.type,options:y.clone.deep.notKeys("relatedInstance")(a.options),children:a.children.map(e.template)};case !c.template(a):return r(a._config);default:throw Error(E+" (array || string || domEl || quickDomEl || template), got "+
String(a));}};E="Template Parse Error: expected";K="link:a anchor:a a text div span h1 h2 h3 h4 h5 h6 header footer section button br ul ol li fieldset input textarea select option form frame hr iframe img picture main nav meta object pre style table tbody th tr td tfoot video".split(" ");t=function(a){var b,c;b=c=a;B.includes(a,":")&&(a=a.split(":"),b=a[0],c=a[1]);return e[b]=function(){return e.apply(null,[c].concat(slice.call(arguments)))}};x=0;for(A=K.length;x<A;x++)F=K[x],t(F);e.version="1.0.17";
return null!=("undefined"!==typeof b&&null!==b?b.exports:void 0)?b.exports=e:"function"===typeof define&&define.amd?define(["quickdom"],function(){return e}):this.Dom=e})();return b.exports}}(this)({});U=function(b){"use strict";var a=[],c=[];return b=function(b,d){if(b===d)return 0;var f=b.length,e=d.length;if(0===f)return e;if(0===e)return f;for(var m,k,g,l,p=0,r=0;p<f;)c[p]=b.charCodeAt(p),a[p]=++p;for(;r<e;)for(m=d.charCodeAt(r),g=r++,k=r,p=0;p<f;p++)l=m===c[p]?g:g+1,g=a[p],k=a[p]=g>k?l>k?k+1:
l:l>g?g+1:l;return k}}.call(this,{});x=I(3);g=I(4);d=function(b){var a={exports:b};(function(){var b,d,e,w,k,h,g,l,p,r,y,t,z,x,B,C,G,E,A,I,F,K,n,v,M,u,O,J,N,Q,L,V,S,T,U,X,ca,fa,Y,P,aa,Z,ga,la,da,ea,ha,ia,ma,ja,ka,na,R,D,ba,oa,W,pa;Q=0;F="push pop shift unshift splice reverse sort".split(" ");S={};K={};ha=["{{","}}"];R=Object.create({silent:!1},{placeholder:{get:function(){return ha},set:function(a){u.isArray(a)&&2===a.length&&(ha=a,ka())}}});L={delay:!1,throttle:!1,simpleSelector:!1,promiseTransforms:!1,
dispatchEvents:!1,sendArrayCopies:!1,updateEvenIfSame:!1,updateOnBind:!0};V=Object.defineProperty;ga=Object.getOwnPropertyDescriptor;v=null;M=function(){var a;v||(a=v=document.createEvent("Event"),a.initEvent("change",!0,!1),a._sb=!0);return v};ma=!("className"in Element.prototype)||!ga(Element.prototype,"className").get;pa="innerWidth innerHeight outerWidth outerHeight scrollX scrollY pageXOffset pageYOffset screenX screenY screenLeft screenTop".split(" ");na=function(a,b){return this.updateAllSubs(b||
this)};Y=function(){return""+ ++Q};P=function(){return Object.create(null)};aa=function(a,b){return function(c,q,d){return E(c,q,d,a,b)}};Z=function(a,c){return a.selfUpdater||(a.selfUpdater=new b(function(){return c?a.setValue(a.fetchDirectValue(),a,!0):a.updateAllSubs(a)},"Func",{}))};D=function(a,b){return a&&-1!==a.indexOf(b)};u={isDefined:function(a){return void 0!==a},isArray:function(a){return a instanceof Array},isObject:function(a){return"object"===typeof a&&a},isString:function(a){return"string"===
typeof a},isNumber:function(a){return"number"===typeof a},isFunction:function(a){return"function"===typeof a},isBindingInterface:function(a){return a instanceof d},isBinding:function(a){return a instanceof b},isIterable:function(a){return u.isObject(a)&&u.isNumber(a.length)},isDom:function(a){return a.nodeName&&1===a.nodeType},isDomInput:function(a){a=a.nodeName;return"INPUT"===a||"TEXTAREA"===a||"SELECT"===a},isDomRadio:function(a){return"radio"===a.type},isDomCheckbox:function(a){return"checkbox"===
a.type},isElCollection:function(a){return a instanceof NodeList||a instanceof HTMLCollection||u.isDefined(jQuery)&&a instanceof jQuery},domElsAreSame:function(a){var b;b=a[0].type;return[].filter.call(a,function(a){return a.type===b}).length===a.length}};fa=function(a,b,c){var q;if(q=ga(a,b))return c&&(q.configurable=!0),q;if(a=Object.getPrototypeOf(a))return fa(a,b,!0)};J=function(a,b,c){var q,d,f,e,H,qa;a.origDescriptor||(a.origDescriptor=fa(b,a.property));c?F.forEach(function(c){return V(b,c,{configurable:!0,
value:function(){var q;q=Array.prototype[c].apply(b,arguments);a.updateAllSubs(a);return q}})}):"Proxy"===a.type?(d=a.origFn=a.value,a.value={result:null,args:null},u.isFunction(d)&&(qa=[].slice,q=f=function(){var c;c=qa.call(arguments);a.value.args=c=a.selfTransform?a.selfTransform(c):c;a.value.result=c=d.apply(b,c);a.updateAllSubs(a);return c},V(b,a.property,{configurable:a.isLiveProp=!0,get:function(){return q},set:function(b){u.isFunction(b)?b!==d&&(b!==f&&(d=a.origFn=b),q!==f&&(q=f)):q=b}}))):
D(a.type,"DOM")||a.object===window&&D(pa,a.property)||(c=a.origDescriptor||S,c.get&&(a.origGetter=c.get.bind(b)),c.set&&(a.origSetter=c.set.bind(b)),H=(H=c.configurable)&&b.constructor!==CSSStyleDeclaration,ma&&a.isDom&&a.property in b.cloneNode(!1)&&(a.origDescriptor=H=!1,a.isLiveProp=!0,a.origGetter=function(){return a.object[a.property]},a.origSetter=function(b){return a.object[a.property]=b}),H&&(H="Array"===a.type,e=!a.origSetter&&!H,V(b,a.property,{configurable:a.isLiveProp=!0,enumerable:c.enumerable,
get:a.origGetter||function(){return a.value},set:function(b){a.setValue(b,a,e)}}),H&&J(a,b[a.property],!0)))};N=function(a,b,c){var q,d;if(c){d=[];a=0;for(c=F.length;a<c;a++)q=F[a],d.push(delete b[q]);return d}c=a.origDescriptor;c.set||c.get||(c.value=a.origFn||a.value);return V(b,a.property,c)};O=function(a){var b,c;b=P();for(c in a)b[c]=a[c];return b};ca=function(a,b){var c,q,d,f;f=Object.keys(b);c=0;for(d=f.length;c<d;c++)q=f[c],a[q]=b[q]};n={get:function(a,b,c,d){if(b)return K[a._sb_ID];if(d&&
a[0]._sb_map&&(b=K[a[0]._sb_map[c]],b.groupBinding))return b.groupBinding;if(a._sb_map&&a._sb_map[c])return K[a._sb_map[c]]},set:function(a,b){var c,q;b?V(a.object,"_sb_ID",{configurable:!0,value:a.ID}):(q=a.selector,a.object._sb_map?a.object._sb_map[q]=a.ID:(c={},c[q]=a.ID,V(a.object,"_sb_map",{configurable:!0,value:c})))}};U=/[.*+?^${}()|[\]\\]/g;da=ea=null;ka=function(){var a,b,c;c=R.placeholder[0].replace(U,"\\$&");a=R.placeholder[1].replace(U,"\\$&");b="[^"+a+"]+";da=new RegExp(c+"("+b+")"+a,
"g");ea=new RegExp(""+c+b+a,"g")};ka();I=function(a,b,c){var q,d,f,e,H;H="";d=f=0;for(e=a.length;f<e;d=++f)q=a[d],H+=q,c[d]&&(H+=b[c[d]]);return H};A=function(a,b,c){null==a[c]&&(a[c]=[]);a[c].push(b)};ja=function(a,b){var c,q,d,f,e,H,m,h,w,k,g;c=Array.prototype.slice.call(a.childNodes);d=0;for(e=c.length;d<e;d++)if(w=c[d],3!==w.nodeType)ja(w,b);else if(w.textContent.match(ea))if(g=w.textContent.split(da),3===g.length&&""===g[0]+g[2])A(b,w,g[1]);else{m=document.createDocumentFragment();q=f=0;for(H=
g.length;f<H;q=++f)k=g[q],h=m.appendChild(document.createTextNode(k)),q%2&&A(b,h,k);w.parentNode.replaceChild(m,w)}};ba=function(a){throw Error("SimplyBind: "+(T[a]||a));};W=function(a,b){var c,d;R.silent||(c=la(b),d=T[a],console.warn("SimplyBind: "+(d+("\n\n"+c))))};oa=function(a){ba("Invalid argument/s ("+a+")",!0)};la=function(a){return(Error().stack||"").split("\n").slice(a+3).join("\n")};T={invalidParamName:"SimplyBind() and .to() only accept a function, an array, a bound object, a string, or a number.",
fnOnly:"Only functions are allowed for .transform/.condition/All()",badEventArg:"Invalid argument number in .ofEvent()",emptyList:"Empty collection provided",onlyOneDOMElement:"You can only pass a single DOM element to a binding",mixedElList:"'checked' of Mixed list of element cannot be bound"};E=function(a,b,c,f,e){if(!a&&0!==a||!(u.isString(a)||u.isNumber(a)||u.isFunction(a)||a instanceof Array))u.isBindingInterface(a)||ba("invalidParamName");!u.isObject(a)||a instanceof Array?(b=new d(b),b.saveOptions=
c,b.isSub=f,b.completeCallback=e,a=u.isFunction(a)?b.setObject(a,!0):b.setProperty(a)):a=e?e(a):a.selfClone();return a};E.version="1.14.5";E.settings=R;E.defaultOptions=L;E.unBindAll=function(a,b){var c,d,q;if(a&&(u.isObject(a)||u.isFunction(a))&&(u.isIterable(a)&&!a._sb_ID&&a[0]&&u.isDom(a[0])&&(a=a[0]),q=a._sb_map,a._sb_ID&&K[a._sb_ID].removeAllSubs(b),q))for(d in q)c=q[d],K[c].removeAllSubs(b)};b=function(a,b,c){ca(this,c);this.optionsDefault=this.saveOptions?this.options:L;this.type=b;this.object=
a;this.ID=Y();this.subs=[];this.subsMeta=P();this.pubsMap=P();this.attachedEvents=[];"Proxy"===this.type&&(this.setValue=na);this.isMultiChoice&&(this.choices=P(),this.object.forEach(function(a){return function(b){var c;c=a.choices[b.value]=E("checked").of(b)._;c.addSub(a);c.subsMeta[a.ID].transformFn=function(){return c};c.groupBinding=a}}(this)));"Event"===this.type||"Func"===this.type&&this.isSub||("Pholder"===this.type?(b=this.descriptor&&!D(this.descriptor,"multi")?this.descriptor+":"+this.property:
this.property,a=this.parentBinding=E(b).of(a)._,a.scanForPholders(),this.value=a.pholderValues[this.pholder],a.textNodes&&(this.textNodes=a.textNodes[this.pholder])):(this.value=a=this.fetchDirectValue(),"ObjectProp"!==this.type||u.isDefined(a)||(this.object[this.property]=a),J(this,this.object)));this.attachEvents();return K[this.ID]=this};b.prototype={addSub:function(a,b,c,d){var q,f,e,m;if(a.isMulti)for(e=a.bindings,a=0,f=e.length;a<f;a++)m=e[a],this.addSub(m,b,c,d);else if(this.subsMeta[a.ID])q=
!0;else{a.pubsMap[this.ID]=this;this.subs.unshift(a);f=this.subsMeta[a.ID]=P();f.updateOnce=c;f.opts=O(b);if(d||"Event"===this.type||"Proxy"===this.type||"Array"===this.type)f.opts.updateEvenIfSame=!0;f.valueRef="Func"===a.type?"valuePassed":"value"}return q},removeSub:function(a,b){var c,d,q,f;if(a.isMulti)for(q=a.bindings,c=0,d=q.length;c<d;c++)f=q[c],this.removeSub(f,b);else this.subsMeta[a.ID]&&(this.subs.splice(this.subs.indexOf(a),1),delete this.subsMeta[a.ID],delete a.pubsMap[this.ID]),b&&
(a.removeSub(this),delete this.pubsMap[a.ID]);0===this.subs.length&&0===Object.keys(this.pubsMap).length&&this.destroy()},removeAllSubs:function(a){var b,c,d,q;d=this.subs.slice();b=0;for(c=d.length;b<c;b++)q=d[b],this.removeSub(q,a)},destroy:function(){var a,b,c,d;delete K[this.ID];this.removePollInterval();if("Event"===this.type)for(d=this.attachedEvents,b=0,c=d.length;b<c;b++)a=d[b],this.unRegisterEvent(a,this.customEventMethod.listen);else"Func"===this.type&&delete this.object._sb_ID;this.isLiveProp&&
this.origDescriptor&&N(this,this.object);"Array"===this.type&&N(this,this.value,!0);this.object._sb_map&&(delete this.object._sb_map[this.selector],0===Object.keys(this.object._sb_map).length&&delete this.object._sb_map)},fetchDirectValue:function(){var a,b,c,d,f;f=this.type;switch(!1){case "Func"!==f:return this.object();case "DOMAttr"!==f:return this.object.getAttribute(this.property)||"";case !this.isMultiChoice:d=[];c=this.choices;for(b in c)if(a=c[b],a.object.checked){if("DOMRadio"===f)return b;
d.push(b)}return d;default:return this.object[this.property]}},setValue:function(a,b,c,d){var f,q,e,m;b||(b=this);this.selfTransform&&(a=this.selfTransform(a));if(!c)switch(this.type){case "ObjectProp":this.isLiveProp?this.isDomInput?d?a!==this.origGetter()&&(f=this.object.selectionStart,this.origSetter(a),f&&this.object.setSelectionRange(f,f)):(this.origSetter(a),R.dispatchEvents&&this.object.dispatchEvent(M())):this.origSetter&&this.origSetter(a):a!==this.value&&(this.object[this.property]=a);break;
case "Pholder":d=this.parentBinding;d.pholderValues[this.pholder]=a;f=I(d.pholderContexts,d.pholderValues,d.pholderIndexMap);if(this.textNodes&&a!==this.value)for(e=this.textNodes,q=0,c=e.length;q<c;q++)m=e[q],m.textContent=a;"textContent"!==this.property&&d.setValue(f,b);break;case "Array":a!==this.value&&(u.isArray(a)||(a=Array.prototype.concat(a)),N(this,this.value,!0),J(this,a=a.slice(),!0),this.origSetter&&this.origSetter(a));break;case "Func":f=this.valuePassed;this.valuePassed=a;a=this.object(a,
f);break;case "Event":this.isEmitter=!0;this.emitEvent(a);this.isEmitter=!1;break;case "DOMRadio":if(this.isMultiChoice)if(d=u.isBinding(a)?a:this.choices[a])for(q in a=d.object.value,f=this.choices,f)c=f[q],c.setValue(c.ID===d.ID,b);else a=this.value;else{a=!!a;if(a===this.value)return;this.object.checked!==a&&(this.object.checked=a);a&&R.dispatchEvents&&this.object.dispatchEvent(M())}break;case "DOMCheckbox":if(this.isMultiChoice){q=!u.isBinding(a);a=[].concat(a);c=d=0;for(e=a.length;d<e;c=++d)m=
a[c],a[c]=u.isBinding(m)?m:this.choices[m];e=[];m=this.choices;for(f in m)c=m[f],d=q?D(a,c):c.value,c.setValue(d,b),d&&e.push(f);a=e}else{a=!!a;if(a===this.value)return;this.object.checked!==a&&(this.object.checked=a,R.dispatchEvents&&this.object.dispatchEvent(M()))}break;case "DOMAttr":this.object.setAttribute(this.property,a)}this.value=a;this.updateAllSubs(b)},updateAllSubs:function(a){var b,c;if(c=(b=this.subs).length)for(;c--;)this.updateSub(b[c],a)},updateSub:function(a,b,c){var d,f,e;if(!(b===
a||b!==this&&b.subsMeta[a.ID])){d=this.subsMeta[a.ID];if(d.opts.throttle){c=+new Date;f=c-d.lastUpdate;if(f<d.opts.throttle)return clearTimeout(d.updateTimer),d.updateTimer=setTimeout(function(c){return function(){return c.updateSub(a,b)}}(this),d.opts.throttle-f);d.lastUpdate=c}else if(d.opts.delay&&!c)return setTimeout(function(c){return function(){return c.updateSub(a,b,!0)}}(this),d.opts.delay);c="Array"===this.type&&d.opts.sendArrayCopies?this.value.slice():this.value;f=a[d.valueRef];c=(e=d.transformFn)?
e(c,f,a.object):c;c===f&&!d.opts.updateEvenIfSame||d.conditionFn&&!d.conditionFn(c,f,a.object)||(d.opts.promiseTransforms&&c&&u.isFunction(c.then)?c.then(function(c){a.setValue(c,b)}):a.setValue(c,b),d.updateOnce&&this.removeSub(a))}},addModifierFn:function(a,b,c,d){var f,e,q,m,h;if(u.isFunction(c)){e=0;for(q=b.length;e<q;e++)m=b[e],h=m._||m,h.isMulti?this.addModifierFn(a,h.bindings,c,d):(m=this.subsMeta[h.ID],m[a]=c,d=d&&!m.updateOnce,this.pubsMap[h.ID]&&((f=h.subsMeta[this.ID])[a]||(f[a]=c)),!d&&
"Func"!==this.type||"transformFn"!==a||this.updateSub(h,this));return!0}return W("fnOnly",2)},setSelfTransform:function(a,b){this.selfTransform=a;b&&this.setValue(this.value)},scanForPholders:function(){var a;this.pholderValues||(this.pholderValues=P(),this.pholderIndexMap=P(),this.pholderContexts=[],u.isString(this.value)&&(this.pholderContexts=this.value.split(ea),a=0,this.value=this.value.replace(da,function(b){return function(c,d){b.pholderIndexMap[a++]=d;return b.pholderValues[d]=d}}(this))),
this.isDom&&"textContent"===this.property&&ja(this.object,this.textNodes=P()))},addPollInterval:function(a){if("Event"!==this.type)return this.removePollInterval(),this.pollInterval=setInterval(function(a){return function(){var b;b=a.fetchDirectValue();return a.setValue(b)}}(this),a)},removePollInterval:function(){clearInterval(this.pollInterval);return this.pollInterval=null},addUpdateListener:function(a,b){this.object.addEventListener(a,function(a){return function(c){c._sb||(c=a.selfTransform&&
a.isDomInput,a.setValue(a.object[b],null,!c,!0))}}(this),!1)},attachEvents:function(){this.eventName?this.registerEvent(this.eventName,this.customEventMethod.listen):this.isDomInput?(this.addUpdateListener("input","value"),this.addUpdateListener("change","value")):this.isMultiChoice||"DOMRadio"!==this.type&&"DOMCheckbox"!==this.type||this.addUpdateListener("change","checked")},registerEvent:function(a,b){this.attachedEvents.push(a);this.invokeEventMethod(a,b||"addEventListener","addEventListener")},
unRegisterEvent:function(a,b){this.attachedEvents.splice(this.attachedEvents.indexOf(a),1);this.invokeEventMethod(a,b||"removeEventListener","removeEventListener")},invokeEventMethod:function(a,b,c){var d;d=this.object;if(this.isDom&&u.isDefined(jQuery)&&"on"===b||"off"===b)d=jQuery(this.object);d[b]||(b=c);this.eventHandler||(this.eventHandler=X.bind(this));if("function"===typeof d[b])d[b](a,this.eventHandler)},emitEvent:function(a){var b,c;c=this.object;b=this.customEventMethod.emit||"dispatchEvent";
this.isDom&&u.isDefined(jQuery)&&"trigger"===b&&(c=jQuery(this.object));c[b]||(b="dispatchEvent");if("dispatchEvent"===b)return this.eventObject||(this.eventObject=document.createEvent("Event"),this.eventObject.initEvent(this.eventName,!0,!0)),this.eventObject.bindingData=a,c[b](this.eventObject);c[b](this.eventName,a)}};X=function(){this.isEmitter||this.setValue(arguments[this.property],null,!0)};d=function(a,b){var c;if(b)ca(this,b),this.stage=1;else for(c in this.stage=0,this.subs=[],this.optionsPassed=
a||(a={}),this.options={},L)this.options[c]=null!=a[c]?a[c]:L[c];return this};e={selfClone:function(){return new d(null,this)},defineMainProps:function(a){this._=a;return Object.defineProperties(this,{value:{get:function(){return a.value}},original:{get:function(){return a.objects||a.object}},subscribers:{get:function(){return a.subs.slice().map(function(a){return a.object})}}})},createBinding:function(a,c,d,f){var e;this.object=a;if(e=n.get(a,f,this.selector,this.isMultiChoice))return this.patchCachedBinding(e);
a=new b(a,c,d);n.set(a,f);return a},patchCachedBinding:function(a){var b,c,d,f;"ObjectProp"!==a.type||this.property in this.object||J(a,this.object);if(this.saveOptions)for(c in d=this.optionsPassed,d)f=d[c],a.optionsDefault[c]=f;c=a.optionsDefault;for(b in c)f=c[b],this.options[b]=u.isDefined(this.optionsPassed[b])?this.optionsPassed[b]:f;return a},setProperty:function(a){var b;u.isNumber(a)&&(a=a.toString());this.selector=this.property=a;this.options.simpleSelector||(D(a,":")&&(b=a.split(":"),this.descriptor=
b.slice(0,-1).join(":"),this.property=b[b.length-1]),D(a,".")&&(b=this.property.split("."),this.property=b[0],this.pholder=b.slice(1).join(".")),D(this.descriptor,"event")&&(D(a,"#")?(b=this.property.split("#"),this.eventName=b[0],this.property=b[1]):(this.eventName=this.property,this.property=0),isNaN(parseInt(this.property))&&W("badEventArg",1),this.customEventMethod={listen:this.optionsPassed.listenMethod,emit:this.optionsPassed.emitMethod}));return this},setObject:function(a,b){var c,d,f,e;this.stage=
1;e=(f=a!==window&&u.isIterable(a)&&!a.nodeType)?a[0]:a;if(!e)f&&u.isElCollection(a)&&ba("emptyList");else if(this.isDom=u.isDom(e))if("checked"===this.property?(d=e&&u.isDomRadio(e),c=!d&&e&&u.isDomCheckbox(e)):"value"===this.property&&(this.isDomInput=u.isDomInput(e)),f&&!D(this.descriptor,"multi"))if(1===a.length)a=a[0];else if(!d&&!c||u.domElsAreSame(a))d||c?(this.isMultiChoice=!0,a=[].slice.call(a)):(a=a[0],W("onlyOneDOMElement",3));else return W("mixedElList",3);switch(!1){case !b:c="Func";
break;case !this.pholder:c="Pholder";break;case !(D(this.descriptor,"array")&&u.isArray(a[this.property])):c="Array";break;case !D(this.descriptor,"event"):c="Event";break;case !D(this.descriptor,"func"):c="Proxy";break;case !d:c="DOMRadio";break;case !c:c="DOMCheckbox";break;case !D(this.descriptor,"attr"):c="DOMAttr";break;default:c="ObjectProp"}D(this.descriptor,"multi")?(a.length||ba("emptyList"),this.defineMainProps(new w(this,a,c))):this.defineMainProps(this.createBinding(a,c,this,b));D(this._.type,
"Event")||D(this._.type,"Proxy")?this.options.updateOnBind=!1:D(this._.type,"Func")&&(this.options.updateOnBind=!0);return this.completeCallback?this.completeCallback(this):this},addToPublisher:function(a){var b,c,d,f;a.stage=2;a.subs.push(this);b=a._.addSub(this._,a.options,a.updateOnce);if(a.updateOnce)delete a.updateOnce;else if(a.options.updateOnBind&&!b)if(this._.isMulti)for(f=this._.bindings,c=0,d=f.length;c<d;c++)b=f[c],a._.updateSub(b,a._);else a._.updateSub(this._,a._)}};d.prototype=Object.create(e,
{of:{get:function(){if(!this.stage)return p}},set:{get:function(){if(this.stage)return y}},chainTo:{get:function(){if(2===this.stage)return h}},transformSelf:{get:function(){if(1===this.stage)return C}},transform:{get:function(){if(2===this.stage)return x}},transformAll:{get:function(){if(2===this.stage)return B}},condition:{get:function(){if(2===this.stage)return g}},conditionAll:{get:function(){if(2===this.stage)return l}},bothWays:{get:function(){if(2===this.stage)return k}},unBind:{get:function(){if(2===
this.stage)return G}},pollEvery:{get:function(){if(this.stage)return r}},stopPolling:{get:function(){if(this.stage)return z}},setOption:{get:function(){if(2===this.stage)return t}},updateOn:{get:function(){var a;if(this.stage&&(a=this))return aa(!1,function(b){b._!==a._&&(a._.pubsMap[b._.ID]=b._,b._.addSub(Z(a._,!0),b.options,!1,!0));return a})}},removeUpdater:{get:function(){var a,b;if(this.stage&&(b=this)&&(a=this._.selfUpdater))return aa(!1,function(c){c._.subsMeta[a.ID]&&(delete b._.pubsMap[c._.ID],
c._.removeSub(a))})}},to:{get:function(){var a;if(1===this.stage&&(a=this))return aa(!0,function(b){b._!==a._&&b.addToPublisher(a);return a})}},and:{get:function(){var a,b;b=this.selfClone();if(2===this.stage)return b;if(1===this.stage)return b._.isMulti||(a=b._,b._=b._=new w(b),b._.addBinding(a)),aa(!1,function(a){b._.addBinding(a._);return b})}},once:{get:function(){var a;if(1===this.stage)return a=this.selfClone(),a.updateOnce=!0,a}},update:{get:function(){return this.set}},twoWay:{get:function(){return this.bothWays}},
pipe:{get:function(){return this.chainTo}}});p=function(a){u.isObject(a)||u.isFunction(a)||oa(a);u.isBindingInterface(a)&&(a=a.object);this.stage=1;return this.setObject(a)};h=function(a,b,c){return E(this.subs[this.subs.length-1]).to(a,b,c)};y=function(a){this._.setValue(a);return this};C=function(a){u.isFunction(a)?this._.setSelfTransform(a,this.options.updateOnBind):W("fnOnly",1);return this};x=function(a){this._.addModifierFn("transformFn",this.subs.slice(-1),a,this.options.updateOnBind);return this};
B=function(a){this._.addModifierFn("transformFn",this.subs,a,this.options.updateOnBind);return this};g=function(a){this._.addModifierFn("conditionFn",this.subs.slice(-1),a);return this};l=function(a){this._.addModifierFn("conditionFn",this.subs,a);return this};k=function(a){var b,c,d,f,e,m;d=this.subs[this.subs.length-1];m=d._;c=this._.isMulti?this._.bindings:[this._];m.addSub(this._,d.options);d=0;for(f=c.length;d<f;d++)b=c[d],e=b.subsMeta[m.ID].transformFn,b=b.subsMeta[m.ID].conditionFn,(e||a)&&
(e=u.isFunction(a)?a:e)&&!1!==a&&(m.subsMeta[this._.ID].transformFn=e),b&&(m.subsMeta[this._.ID].conditionFn=b);return this};G=function(a){var b,c,d,f;d=this.subs;b=0;for(c=d.length;b<c;b++)f=d[b],this._.removeSub(f._,a);return this};r=function(a){this._.addPollInterval(a);return this};z=function(){this._.removePollInterval();return this};t=function(a,b){this._.subsMeta[this.subs[this.subs.length-1]._.ID].opts[a]=b;return this};w=function(a,b,c){var d,f,e;a.selector=a.selector.slice(6);ca(this,this["interface"]=
a);this.isMulti=!0;this.bindings=d=[];if(b)for(a=0,f=b.length;a<f;a++)e=b[a],this.addBinding(e,c);return Object.defineProperties(this,{type:{get:function(){return d.map(function(a){return a.type})}},value:{get:function(){return d.map(function(a){return a.value})}}})};ia=w.prototype=Object.create(e);Object.keys(b.prototype).forEach(function(a){return ia[a]=function(b,c,d,f){var e,m,h,w;w=this.bindings;m=0;for(h=w.length;m<h;m++)e=w[m],"updateSub"===a&&(c=e),e[a](b,c,d,f)}});ia.addBinding=function(a,
b){this.bindings.push(b?this.createBinding(a,b,this["interface"]):a)};return null!=("undefined"!==typeof a&&null!==a?a.exports:void 0)?a.exports=E:"function"===typeof define&&define.amd?define(["simplybind"],function(){return E}):this.SimplyBind=E})();return a.exports}.call(this,{});G=function(b){var a;g.object(b)||(b={});null==b.type&&(b.type="text");C.appended||C();a=Object.create(r[b.type].prototype);return r.call(a,b)};G.registerField=function(b,a){var c,d,e,w;if(g.string(b)&&g.object(a)){e=Object.create(r.prototype);
for(d in a)c=a[d],d="_"===d[0]?d.slice(1):d,k.includes(S,d)&&"validate"!==d&&(d="_"+d),e[d]=c;c=0;for(d=S.length;c<d;c++)if(w=S[c],!e["_"+w]||e[w])throw Error("Field Registration: '"+w+"' is required in order to register the field");return r[b]=e}};Object.defineProperty(G,"fields",{get:function(){return x.clone.own.notKeys("instances")(r)}});null==this.console&&(this.console={});null==console.log&&(console.log=function(){});null==console.warn&&(console.warn=console.log);S=["_construct","_createElements",
"_attachBindings","_validate"];z=null!=document.createElement("div").style.animation?"":"-webkit-";A="@"+z+"keyframes checkmarkAnimateSuccessTip { 0%, 54% { width: 0; left: 0px; top: 3px } 70% { width: 14px; left: -2px; top: 8px } 84% { width: 5px; left: 5px; top: 10px } 100% { width: 8px; left: 3px; top: 10px } } @"+z+"keyframes checkmarkAnimateSuccessLong { 0%, 65% { width: 0; right: 12px; top: 12px } 84% { width: 14px; right: 0px; top: 7px } 100% { width: 12px; right: 2px; top: 8px } } @"+z+"keyframes checkmarkAnimateError { 0%, 65% { "+
z+"transform: scale(0.4); opacity: 0 } 84% { "+z+"transform: scale(1.15) } 100% { "+z+"transform: scale(1) } } @"+z+"keyframes checkmarkRotatePlaceholder { 0%, 5% { "+z+"transform: rotate(-45deg) } 12%, 100% { "+z+"transform: rotate(-405deg) } } @"+z+"keyframes fieldErrorShake { 0%, 50% { "+z+"transform: translateX(-10px) } 25%, 75% { "+z+"transform: translateX(10px) } 100% { "+z+"transform: translateX(0px) } }";C=function(){var b;b=document.createElement("style");b.innerHTML=A;document.body.appendChild(b);
return C.appended=b};z={checkmark:e.template(["*svg",{attrs:{width:"12px",height:"12px",viewBox:"5 7 12 12",tabindex:-1,focusable:!1},style:{width:"9px",height:"9px"}},["*polyline",{attrs:{"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none",points:"7 13.8888889 9.66666667 17 15 9",tabindex:-1,focusable:!1}}]]),angleDown:e.template(["*svg",{attrs:{width:"1792px",height:"1792px",viewBox:"0 0 1792 1792",tabindex:-1,focusable:!1},style:{width:"100%",height:"100%",outline:"none"}},
["*path",{attrs:{tabindex:-1,focusable:!1,d:"M1395 736q0 13-10 23l-466 466q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l393 393 393-393q10-10 23-10t23 10l50 50q10 10 10 23z"}}]]),caretUp:e.template(["*svg",{attrs:{viewBox:"0 0 512 512",tabindex:-1,focusable:!1},style:{width:"100%",height:"100%"}},["*path",{attrs:{tabindex:-1,focusable:!1,d:"M402 347c0 5-2 10-5 13-4 4-8 6-13 6h-256c-5 0-9-2-13-6-3-3-5-8-5-13s2-9 5-12l128-128c4-4 8-6 13-6s9 2 13 6l128 128c3 3 5 7 5 12z"}}]]),
caretDown:e.template(["*svg",{attrs:{viewBox:"0 0 512 512",tabindex:-1,focusable:!1},style:{width:"100%",height:"100%"}},["*path",{attrs:{tabindex:-1,focusable:!1,d:"M402 201c0 5-2 9-5 13l-128 128c-4 4-8 5-13 5s-9-1-13-5l-128-128c-3-4-5-8-5-13s2-9 5-13c4-3 8-5 13-5h256c5 0 9 2 13 5 3 4 5 8 5 13z"}}]])};g.field=function(b){return b instanceof r};g.regex=function(b){return b instanceof RegExp};X=/^\d$/;F=/^[a-zA-Z]$/;N=/^[0-9\!#\$\%\*\+\/\=\?\^\{\|\}\(\)\~\-\.]$/;Q=/^[0-9A-Za-z\!#\$\%\&\'\*\+\/\=\?\^\_\`\{\|\}\(\)\~\-\ ]$/;
k={};Z=function(){};k.includes=function(b,a){return b&&-1!==b.indexOf(a)};k.removeItem=function(b,a){var c;c=b.indexOf(a);if(-1!==c)return b.splice(c,1)};k.diff=function(b,a){var c,d,e,w,l;w=[];e=Math.max(b.length,a.length);for(d=-1;++d<e;)l=b[d],c=a[d],l!==c&&(g.defined(l)&&!k.includes(a,l)&&w.push(l),g.defined(c)&&!k.includes(b,c)&&w.push(c));return w};k.hexToRGBA=function(b,a){var c,d,e;"#"===b[0]&&(b=b.slice(1));e=parseInt(b.slice(0,2),16);d=parseInt(b.slice(2,4),16);c=parseInt(b.slice(4,6),16);
return"rgba("+e+", "+d+", "+c+", "+a+")"};k.unlockScroll=function(b){window._isLocked=!1;return e(window).off("wheel.lock")};k.lockScroll=function(b){if(!window._isLocked)return window._isLocked=!0,e(window).on("wheel.lock",function(a){if(a.target===b.raw||e(a.target).parentMatching(function(a){return a===b})){if(0<a.wheelDelta&&0===b.raw.scrollTop||0>a.wheelDelta&&b.raw.scrollHeight-b.raw.scrollTop===b.raw.clientHeight)return a.preventDefault()}else return a.preventDefault()})};k.fuzzyMatch=function(b,
a,c){var d,e,w,k,h;k=b.length;d=a.length;c||(b=b.toUpperCase(),a=a.toUpperCase());if(k>d)return!1;if(k===d)return b===a;for(w=c=e=0;w<k;)for(h=b[w++];c<d;)if(a[c++]===h){e++;break}return e===k};k.getIndexOfFirstDiff=function(b,a){var c,d;c=0;for(d=Math.max(b.length,a.length);c<d;){if(b[c]!==a[c])return c;c++}return null};k.testCondition=function(b){var a,c,d;if(!b||!b.target)throw Error("Invalid condition provided: "+JSON.stringify(b));if(!b.target.state.visible)return!1;a=function(){switch(!1){case !g.objectPlain(b.value):return b.value;
case !g.regex(b.value):return{$regex:b.value};case !("valid"===b.value&&!b.property||!g.defined(b.value)):return"valid";default:return{$eq:b.value}}}();if("valid"===a)return b.target.validate();d=function(){var a,c;c=b.property.split(".");switch(!1){case 1!==c.length:return b.target[b.property];case !g.defined(b.target[b.property]):return b.target[b.property];default:for(a=b.target;g.object(a);)a=a[c.pop()];return a}}();c=Object.keys(a);return c.filter(function(b){var c;c=a[b];switch(b){case "$eq":return d===
c;case "$ne":return d!==c;case "$gt":return d>c;case "$gte":return d>=c;case "$lt":return d<c;case "$lte":return d<=c;case "$ct":return k.includes(d,c);case "$nct":return!k.includes(d,c);case "$regex":return c.test(d);case "$nregex":return!c.test(d);case "$mask":return k.testMask(d,c);default:return!1}}).length===c.length};k.validateConditions=function(b){var a;if(b)return a=b.filter(function(a){return k.testCondition(a)}),a.length===b.length};k.initConditions=function(b,a,c){return setTimeout(function(e){return function(){a.forEach(function(a){var e;
if(e=g.string(a.target)?b.allFields[a.target]:g.field(a.target)?a.target:void 0)a.target=e;else return console.warn("Condition target not found for the provided ID '"+a.target+"'",b);a=g.array(e.value)?"array:value":"value";return d(a,{updateOnBind:!1}).of(e).and("visible").of(e.state).to(c)});return c()}}(this))};T={fontFamily:"system-ui, sans-serif",templates:{},label:!1,alwaysShowHelp:!1,help:"",defaultValue:""};r=function(b){var a;this.settings=x.deep.clone.deep.transform({conditions:function(a){var b,
c,d;if(g.objectPlain(a)){b=[];for(c in a)d=a[c],b.push({target:c,value:d});return b}if(g.array(a))return a.map(function(a){return g.string(a)?{target:a}:a})},choices:function(a){var b,c,d;if(g.objectPlain(a)){c=[];for(b in a)d=a[b],c.push({label:b,value:d});return c}if(g.array(a))return a.map(function(a){return g.objectPlain(a)?a:{label:a,value:a}})},validWhenRegex:function(a){return g.string(a)?new RegExp(a):a}})(T,this._defaults,b);this.type=b.type;this.allFields=this.settings.fieldInstances||r.instances;
this.value=null;this.ID=this.settings.ID||Y++ +"";this.els={};this._eventCallbacks={};this.state={valid:!0,visible:!0,disabled:!1,focused:!1,hovered:!1,filled:!1,interacted:!1,showError:!1,showHelp:!1,width:"100%"};null!=this.settings.defaultValue&&(this.value=this.settings.multiple?[].concat(this.settings.defaultValue):this.settings.defaultValue);null!=(a=this.settings.conditions)&&a.length&&(this.state.visible=!1,k.initConditions(this,this.settings.conditions,function(a){return function(){return a.validateConditions()}}(this)));
this.allFields[this.ID]&&"undefined"!==typeof console&&null!==console&&console.warn("Duplicate field IDs found: '"+this.ID+"'");this._construct();this._createElements();this._attachBindings();this.els.field.onInserted(function(a){return function(){return a.emit("inserted")}}(this));return this.allFields[this.ID]=this.els.field.raw._quickField=this};r.instances=Object.create(null);Y=0;Object.defineProperty(r.prototype,"valueRaw",{get:function(){return this.value}});r.prototype.appendTo=function(b){this.els.field.appendTo(b);
return this};r.prototype.prependTo=function(b){this.els.field.prependTo(b);return this};r.prototype.insertAfter=function(b){this.els.field.insertAfter(b);return this};r.prototype.insertBefore=function(b){this.els.field.insertBefore(b);return this};r.prototype.validateConditions=function(b){var a;b?a=!1:(b=this.settings.conditions,a=!0);b=k.validateConditions(b);return a?this.state.visible=b:b};r.prototype.on=function(b,a){var c;g.string(b)&&g["function"](a)&&(null==(c=this._eventCallbacks)[b]&&(c[b]=
[]),this._eventCallbacks[b].push(a));return this};r.prototype.off=function(b,a){this._eventCallbacks[b]&&(g["function"](a)?k.removeItem(this._eventCallbacks[b],a):this._eventCallbacks[b]={});return this};r.prototype.emit=function(){var b,a,c,d,e;a=arguments[0];b=2<=arguments.length?slice.call(arguments,1):[];if(this._eventCallbacks[a])for(e=this._eventCallbacks[a],c=0,d=e.length;c<d;c++)a=e[c],a.apply(null,[this].concat(slice.call(b)));return this};r.text=l=function(){return this};l.prototype=Object.create(r.prototype);
l.prototype._templates={field:e.template(["div",{style:{position:"relative",display:"none",boxSizing:"border-box",fontFamily:function(b){return b.settings.fontFamily},$visible:{display:"inline-block"},$showError:{animation:"0.2s fieldErrorShake"}}}]),fieldInnerwrap:e.template(["div",{style:{position:"relative",height:"46px",backgroundColor:"white",borderWidth:"1px",borderStyle:"solid",borderColor:"#d3d3d3",borderRadius:"2px",boxSizing:"border-box",fontFamily:"inherit",transition:"border-color 0.2s",
$focus:{borderColor:"#ff9c00"},$showError:{borderColor:"#cc4820"},$disabled:{borderColor:"#d3d3d3",backgroundColor:"#d3d3d3"}}}]),label:e.template(["div",{style:{position:"absolute",zIndex:1,top:function(b){return parseFloat(b.els.fieldInnerwrap.raw.style.height)/6},left:function(b){var a;return parseFloat(null!=(a=b.els.icon)?a.styleSafe("width"):void 0)||0},padding:"0 12px",fontFamily:"inherit",fontSize:"11px",fontWeight:600,lineHeight:"1em",color:"#909090",opacity:0,transition:"opacity 0.2s, color 0.2s",
whiteSpace:"nowrap",userSelect:"none",cursor:"default",pointerEvents:"none",$filled:{opacity:1},$focus:{color:"#ff9c00"},$showError:{color:"#cc4820"}}}]),input:e.template(["input",{type:"text",style:{position:"relative",zIndex:3,display:"inline-block",verticalAlign:"top",width:function(b){var a;if(!b.settings.autoWidth)return a="",b.els.icon&&(a+=" -"+b.els.icon.raw.styleSafe("width",!0)),b.els.checkmark&&(a+=" -"+b.els.checkmark.styleSafe("width",!0)),"calc(100% + ("+(a||"0px")+"))"},height:function(){return this.parent.styleSafe("height")},
margin:"0",padding:"0 12px",backgroundColor:"transparent",appearance:"none",border:"none",outline:"none",fontFamily:"inherit",fontSize:"14px",lineHeight:function(){return this.parent.styleSafe("height")},color:"#181818",boxSizing:"border-box",whiteSpace:"nowrap",transform:"translateY(0)",transition:"transform 0.2s, -webkit-transform 0.2s",$filled:{$hasLabel:{transform:function(b){return"translateY("+parseFloat(b.els.fieldInnerwrap.style("height"))/8+"px)"}}},$showCheckmark:{padding:"0 44px 0 12px"}}}]),
placeholder:e.template(["div",{style:{position:"absolute",zIndex:2,top:"0px",left:function(b){var a;return(null!=(a=b.els.icon)?a.styleSafe("width"):void 0)||0},lineHeight:function(){return this.parent.styleSafe("height")},padding:function(b){return b.els.input.styleSafe("padding")},fontFamily:function(b){return b.els.input.styleSafe("fontFamily")},fontSize:function(b){return b.els.input.styleSafe("fontSize")},color:"#181818",opacity:.5,userSelect:"none",whiteSpace:"nowrap",transform:"translateY(0)",
transition:"transform 0.2s, -webkit-transform 0.2s",$filled:{visibility:"hidden",$hasLabel:{transform:function(b){return"translateY("+parseFloat(b.els.fieldInnerwrap.style("height"))/8+"px)"}}}}}]),help:e.template(["div",{style:{position:"absolute",top:function(b){return parseFloat(this.parent.styleSafe("height"))+4+"px"},left:"0px",fontFamily:"inherit",fontSize:"11px",color:"#909090",display:"none",$showError:{color:"#cc4820",display:"block"},$showHelp:{display:"block"}}}]),checkmark:e.template(["div",
{style:{position:"relative",zIndex:4,display:"none",width:"38px",height:"100%",paddingTop:function(){return parseFloat(this.parent.styleSafe("height"))/2-13},paddingRight:"12px",verticalAlign:"top",boxSizing:"border-box",$filled:{display:"inline-block"}}},["div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"white",borderWidth:"3px",borderStyle:"solid",borderColor:"#72c322",transform:"scale(0.8)",$showError:{borderColor:"#cc4820"}}},["div",{style:{position:"absolute",top:"-4px",
left:"-10px",width:"15px",height:"30px",borderRadius:"30px 0 0 30px",backgroundColor:function(){return this.parent.raw.style.backgroundColor},transform:"rotate(-45deg)",transformOrigin:"15px 15px 0"}}],["div",{style:{position:"absolute",top:"-5px",left:"8px",width:"15px",height:"30px",borderRadius:"0 30px 30px 0",backgroundColor:function(){return this.parent.raw.style.backgroundColor},transform:"rotate(-45deg)",transformOrigin:"0 15px 0",$filled:{animation:"4.25s ease-in checkmarkRotatePlaceholder",
$invalid:{animation:""}}}}],["div",{style:{$filled:{$invalid:{position:"relative",zIndex:2,animation:"0.55s checkmarkAnimateError",transformOrigin:"50% 10px"}}}},["div",{style:{position:"absolute",zIndex:2,top:"10px",left:"3px",display:"block",width:"8px",height:"3px",borderRadius:"2px",backgroundColor:"#72c322",transform:"rotate(45deg)",$filled:{animation:"0.75s checkmarkAnimateSuccessTip"},$invalid:{backgroundColor:"#cc4820",left:"4px",top:"8px",width:"12px",$filled:{animation:""}}}}],["div",{style:{position:"absolute",
zIndex:2,top:"8px",right:"2px",display:"block",width:"12px",height:"3px",borderRadius:"2px",backgroundColor:"#72c322",transform:"rotate(-45deg)",$filled:{animation:"0.75s checkmarkAnimateSuccessLong"},$invalid:{backgroundColor:"#cc4820",top:"8px",left:"4px",right:"auto",$filled:{animation:""}}}}]],["div",{style:{position:"absolute",zIndex:2,top:"-4px",left:"-3px",width:"20px",height:"20px",borderRadius:"50%",borderWidth:"3px",borderStyle:"solid",borderColor:k.hexToRGBA("#72c322",.4),$invalid:{borderColor:k.hexToRGBA("#cc4820",
.4)}}}],["div",{style:{position:"absolute",zIndex:1,top:"-2px",left:"6px",width:"4px",height:"28px",backgroundColor:function(){return this.parent.raw.style.backgroundColor},transform:"rotate(-45deg)"}}]]])};l.prototype._defaults={mask:!1,maskPlaceholder:" ",maskGuide:!0,placeholder:!0,validWhenIsChoice:!1,validWhenRegex:!1,autoWidth:!1,checkmark:!0,keyboard:"text",dropdownOptions:{storeSelected:!1,lockScroll:!1},choices:null};l.prototype._construct=function(){this.state.typing=!1;this.cursor={prev:0,
current:0};this.helpMessage=this.settings.alwaysShowHelp?this.settings.help:"";if(!this.settings.mask){var b=this.settings,a;a:{switch(this.settings.keyboard){case "number":case "phone":case "tel":a="1+";break a;case "email":a="*+@*+.aa+";break a}a=void 0}b.mask=a}this.settings.mask&&(this.mask=new O(this.settings.mask,this.settings.maskPlaceholder,this.settings.maskGuide))};l.prototype._createElements=function(){var b,a;b={relatedInstance:this,styleAfterInsert:!0};this.els.field=this._templates.field.spawn(this.settings.templates.field,
b);this.els.fieldInnerwrap=this._templates.fieldInnerwrap.spawn(this.settings.templates.fieldInnerwrap,b).appendTo(this.els.field);this.els.label=this._templates.label.spawn(this.settings.templates.label,b).prependTo(this.els.field);this.els.input=this._templates.input.spawn(this.settings.templates.input,b);this.els.placeholder=this._templates.placeholder.spawn(this.settings.templates.placeholder,b);this.els.help=this._templates.help.spawn(this.settings.templates.help,b);this.settings.choices&&(this.dropdown=
new p(this.settings.choices,this),this.dropdown.appendTo(this.els.fieldInnerwrap));this.settings.icon&&(g.string(this.settings.icon)&&(a=this.settings.icon),this.els.icon=this._templates.icon.spawn(this.settings.templates.icon,b,a).insertBefore(this.els.label));this.settings.checkmark&&(this.els.checkmark=this._templates.checkmark.spawn(this.settings.templates.checkmark,b).appendTo(this.els.fieldInnerwrap),this.els.input.insertBefore(this.els.checkmark));this.els.help.appendTo(this.els.fieldInnerwrap);
this.els.input.parent||this.els.input.insertBefore(this.els.help);this.els.input.prop("type",function(){switch(this.settings.keyboard){case "number":case "tel":case "phone":return"tel";case "password":return"password";case "url":return"url";default:return"text"}}.call(this));this.els.placeholder.insertAfter(this.els.input);this.els.field.state("hasLabel",this.settings.label);this.els.fieldInnerwrap.raw._quickField=this.els.input.raw._quickField=this};l.prototype._attachBindings=function(){var b;b=
{listenMethod:"on"};d("visible").of(this.state).to(function(a){return function(b){return a.els.field.state("visible",b)}}(this));d("hovered").of(this.state).to(function(a){return function(b){return a.els.field.state("hover",b)}}(this));d("focused").of(this.state).to(function(a){return function(b){return a.els.field.state("focus",b)}}(this));d("filled").of(this.state).to(function(a){return function(b){return a.els.field.state("filled",b)}}(this));d("disabled").of(this.state).to(function(a){return function(b){return a.els.field.state("disabled",
b)}}(this));d("showError").of(this.state).to(function(a){return function(b){return a.els.field.state("showError",b)}}(this));d("showHelp").of(this.state).to(function(a){return function(b){return a.els.field.state("showHelp",b)}}(this));d("valid").of(this.state).to(function(a){return function(b){a.els.field.state("valid",b);return a.els.field.state("invalid",!b)}}(this));d("showError",{updateOnBind:!1}).of(this.state).to(function(a){return function(b,d){switch(!1){case !g.string(b):return a.els.help.text(b);
case !g.string(d):return a.els.help.text(a.helpMessage)}}}(this));d("label").of(this.settings).to("textContent").of(this.els.label.raw);d("placeholder").of(this.settings).to("textContent").of(this.els.placeholder.raw).transform(function(a){return function(b){switch(!1){case !(!0===b&&a.settings.label):return a.settings.label;case !g.string(b):return b;default:return""}}}(this));d("helpMessage").of(this).to("textContent").of(this.els.help.raw).condition(function(a){return function(){return!a.state.showError}}(this));
d("width",{updateEvenIfSame:!0}).of(this.state).to(function(a){return function(b){return(a.settings.autoWidth?a.els.input:a.els.field).style({width:b})}}(this));this.settings.autoWidth&&d("value",{updateEvenIfSame:!0,updateOnBind:!1}).of(this).to(function(a){return function(b){var c;b?(a.els.input.style("width",0),a.els.input.raw.scrollLeft=1E10,b=Math.max(a.els.input.raw.scrollLeft+a.els.input.raw.offsetWidth,a.els.input.raw.scrollWidth)+2,c="absolute"===a.els.label.styleSafe("position")?a.els.label.rect.width:
0):(b=a.els.placeholder.rect.width,c=0);return a.state.width=Math.max(b,c)+"px"}}(this)).updateOn("event:inserted",{listenMethod:"on"}).of(this);d("value").of(this.els.input.raw).transformSelf(function(a){return function(b){a.mask&&(a.mask.setValue(b),a.cursor.current=a.selection().start,b=a.mask.valueRaw?a.mask.value:"");return b}}(this)).to("value").of(this).bothWays();d("value").of(this).to("valueRaw").of(this).transform(function(a){return function(b){return a.mask?a.mask.valueRaw:b}}(this));d("valueRaw").of(this).to(function(a){return function(b){a.state.filled=
!!b;b&&(a.state.interacted=!0);a.state.valid=a.validate();return a.emit("input")}}(this));this.settings.mask&&d("value",{updateEvenIfSame:!0}).of(this.els.input.raw).to(function(a){return function(b){if(a.state.focused)return a._scheduleCursorReset()}}(this));this.dropdown&&(d("typing",{updateEvenIfSame:!0}).of(this.state).to(function(a){return function(b){if(b){if(a.valueRaw)return a.dropdown.isOpen=!0,d("event:click").of(document).once.to(function(){return a.dropdown.isOpen=!1}).condition(function(b){return!e(b.target).parentMatching(function(b){return b===
a.els.fieldInnerwrap})})}else return setTimeout(function(){return a.dropdown.isOpen=!1},300)}}(this)),d("valueRaw",{updateOnBind:!1}).of(this).to(function(a){return function(b){var c,d,e,g,h;g=a.dropdown.options;c=0;for(d=g.length;c<d;c++)e=g[c],h=b?k.fuzzyMatch(b,e.value):!0,e.visible!==h&&(e.visible=h);a.dropdown.isOpen&&!b&&(a.dropdown.isOpen=!1)}}(this)),this.dropdown.onSelected(function(a){return function(b){a.value=b.label;b.value!==b.label&&(a.valueRaw=b.value);a.dropdown.isOpen=!1;return a.selection(a.els.input.raw.value.length)}}(this)));
d("event:mouseenter",b).of(this.els.input).to(function(a){return function(){return a.state.hovered=!0}}(this));d("event:mouseleave",b).of(this.els.input).to(function(a){return function(){return a.state.hovered=!1}}(this));d("event:focus",b).of(this.els.input).to(function(a){return function(){a.state.focused=!0;if(a.state.disabled)return a.blur()}}(this));d("event:blur",b).of(this.els.input).to(function(a){return function(){return a.state.typing=a.state.focused=!1}}(this));d("event:input",b).of(this.els.input).to(function(a){return function(){return a.state.typing=
!0}}(this));d("event:keydown",b).of(this.els.input).to(function(a){return function(){return a.cursor.prev=a.selection().end}}(this))};l.prototype.validate=function(b){var a;null==b&&(b=this.value);switch(!1){case !(this.settings.validWhenRegex&&g.regex(this.settings.validWhenRegex)):return this.settings.validWhenRegex.test(b);case !(this.settings.validWhenIsChoice&&null!=(a=this.settings.choices)&&a.length):return a=this.settings.choices.filter(function(a){return a.value===b}),!!a.length;case !this.mask:return this.mask.validate(b);
default:return!!b}};l.prototype._scheduleCursorReset=function(){var b,a;k.getIndexOfFirstDiff(this.mask.value,this.mask.prev.value);b=this.cursor.current;a=this.mask.normalizeCursorPos(b,this.cursor.prev);a!==b&&this.selection(a)};l.prototype.selection=function(b){var a,c;g.object(b)?(c=b.start,a=b.end):c=b;if(null!=c){if(!a||a<c)a=c;this.els.input.raw.setSelectionRange(c,a)}else return{start:this.els.input.raw.selectionStart,end:this.els.input.raw.selectionEnd}};l.prototype.focus=function(){return this.els.input.raw.focus()};
l.prototype.blur=function(){return this.els.input.raw.blur()};r.select=t=function(){return this};t.prototype=Object.create(r.prototype);t.prototype._templates={field:e.template(["div",{style:x.clone(l.prototype._templates.field.options.style)}]),fieldInnerwrap:e.template(["div",{style:x.clone(l.prototype._templates.fieldInnerwrap.options.style)}]),label:e.template(["div",{style:x.clone(l.prototype._templates.label.options.style)}]),input:e.template(["div",{props:{tabIndex:0},style:x.clone(l.prototype._templates.input.options.style,
{userSelect:"none",overflow:"scroll"})}]),placeholder:e.template(["div",{style:x.clone(l.prototype._templates.placeholder.options.style)}]),caret:e.template(["div",{style:{position:"relative",zIndex:3,top:function(b){return parseFloat(b.els.input.style("height"))/2-8.5},display:"inline-block",width:"29px",height:"17px",paddingRight:"12px",boxSizing:"border-box",verticalAlign:"top",outline:"none",pointerEvents:"none",fill:"#909090"}},z.caretDown]),help:e.template(["div",{style:x.clone(l.prototype._templates.help.options.style)}])};
t.prototype._defaults={placeholder:!0,validWhenIsChoice:!1,validWhenRegex:!1,validWhenChoseMin:Infinity,autoWidth:!1,labelFilter:null,choices:[],multiple:!1,dropdownOptions:{}};t.prototype._construct=function(){var b;if(null==(b=this.settings.choices)||!b.length)throw Error("Choices were not provided for choice field '"+(this.settings.label||this.ID)+"'");this.settings.defaultValue||(this.value=this.settings.multiple?[]:null);this.state.showHelp=this.settings.alwaysShowHelp?this.settings.help:!1;
if(this.settings.dropdownOptions.multiple=this.settings.multiple)this.settings.dropdownOptions.help="Tip: press ESC to close this menu"};t.prototype._createElements=function(){var b;b={relatedInstance:this,styleAfterInsert:!0};this.els.field=this._templates.field.spawn(this.settings.templates.field,b);this.els.fieldInnerwrap=this._templates.fieldInnerwrap.spawn(this.settings.templates.fieldInnerwrap,b).appendTo(this.els.field);this.els.label=this._templates.label.spawn(this.settings.templates.label,
b).prependTo(this.els.field);this.els.input=this._templates.input.spawn(this.settings.templates.input,b).appendTo(this.els.fieldInnerwrap);this.els.placeholder=this._templates.placeholder.spawn(this.settings.templates.placeholder,b).insertBefore(this.els.input);this.els.help=this._templates.help.spawn(this.settings.templates.help,b).appendTo(this.els.fieldInnerwrap);this.els.caret=this._templates.caret.spawn(this.settings.templates.caret,b).appendTo(this.els.fieldInnerwrap);this.els.checkmark=this.els.caret;
this.dropdown=new p(this.settings.choices,this);this.dropdown.appendTo(this.els.fieldInnerwrap);this.settings.label&&(this.els.label.text(this.settings.label),this.els.field.state("hasLabel",!0));this.els.fieldInnerwrap.raw._quickField=this.els.input.raw._quickField=this};t.prototype._attachBindings=function(){var b;b={listenMethod:"on"};d("visible").of(this.state).to(function(a){return function(b){return a.els.field.state("visible",b)}}(this));d("hovered").of(this.state).to(function(a){return function(b){return a.els.field.state("hover",
b)}}(this));d("focused").of(this.state).to(function(a){return function(b){return a.els.field.state("focus",b)}}(this));d("filled").of(this.state).to(function(a){return function(b){return a.els.field.state("filled",b)}}(this));d("disabled").of(this.state).to(function(a){return function(b){return a.els.field.state("disabled",b)}}(this));d("showError").of(this.state).to(function(a){return function(b){return a.els.field.state("showError",b)}}(this));d("showHelp").of(this.state).to(function(a){return function(b){return a.els.field.state("showHelp",
b)}}(this));d("valid").of(this.state).to(function(a){return function(b){a.els.field.state("valid",b);return a.els.field.state("invalid",!b)}}(this));d("showHelp").of(this.state).to("textContent").of(this.els.help.raw).transform(function(a){return a?a:""}).condition(function(a){return function(){return!a.state.showError}}(this));d("showError",{updateOnBind:!1}).of(this.state).to(function(a){return function(b,d){switch(!1){case !g.string(b):return a.els.help.text(b);case !g.string(d):return a.els.help.text(a.state.showError)}}}(this));
d("placeholder").of(this.settings).to("textContent").of(this.els.placeholder.raw).transform(function(a){return function(b){switch(!1){case !(!0===b&&a.settings.label):return a.settings.label;case !g.string(b):return b;default:return""}}}(this));d("width",{updateEvenIfSame:!0}).of(this.state).to(function(a){return function(b){return(a.settings.autoWidth?a.els.input:a.els.field).style({width:b})}}(this));this.settings.autoWidth&&setTimeout(function(a){return function(){return d("valueLabel",{updateEvenIfSame:!0,
updateOnBind:!1}).of(a).to(function(b){var c;b?(a.els.input.style("width",0),b=a.els.input.raw.scrollWidth+2,c="absolute"===a.els.label.styleSafe("position")?a.els.label.rect.width:0):(b=a.els.placeholder.rect.width,c=0);return a.state.width=Math.max(b,c)+"px"}).updateOn("event:inserted",{listenMethod:"on"}).of(a)}}(this));d("array:selected",{updateOnBind:!1}).of(this.dropdown).to("value").of(this).transform(function(a){return function(b){return b?a.settings.multiple?b.map(function(a){return a.value}):
b.value:b}}(this));d("value").of(this).to(function(a){return function(b){var c,d,e;if(b)if(a.settings.multiple&&g.array(b))for(c=0,d=b.length;c<d;c++)e=b[c],a.dropdown.setOptionFromString(e);else a.dropdown.setOptionFromString(b)}}(this));d("value").of(this).to("valueLabel").of(this).transform(function(a){return function(b){switch(!1){case !a.settings.multiple:return b.map(a.dropdown.getLabelOfOption.bind(a.dropdown)).join(", ");case "string"===typeof b:return"";default:return a.dropdown.getLabelOfOption(b)}}}(this));
d("valueLabel").of(this).to("textContent").of(this.els.input.raw).transform(function(a){return function(b){return a.settings.labelFormat?a.settings.labelFormat(b):b}}(this)).and.to(function(a){return function(b){a.state.filled=!!b;b&&(a.state.interacted=!0);return a.state.valid=a.validate()}}(this));d("array:value",{updateOnBind:!1}).of(this).to(function(a){return function(){return a.emit("input")}}(this));d("event:click",b).of(this.els.input).to(function(a){return function(){var b,f;if(!a.state.disabled)return a.dropdown.isOpen=
!0,b=d("event:click").of(document).once.to(function(){return a.dropdown.isOpen=!1}).condition(function(b){return!e(b.target).parentMatching(function(b){return b===a.els.fieldInnerwrap})}),f=d("event:keydown").of(document).once.to(function(){return a.dropdown.isOpen=!1}).condition(function(a){return 27===a.keyCode}),d("isOpen",{updateOnBind:!1}).of(a.dropdown).once.to(function(){b.unBind();return f.unBind()}).condition(function(a){return!a})}}(this));d("focused",{updateOnBind:!1}).of(this.state).to(function(a){return function(b){var c;
return b?(c=[32,37,38,39,40],a.els.input.on("keydown.dropdownTrigger",function(b){var d;if(k.includes(c,b.keyCode)&&!a.dropdown.isOpen)return a.dropdown.isOpen=!0,null!=(d=a.dropdown.lastSelected)&&d.selected&&(a.dropdown.currentHighlighted=a.dropdown.lastSelected),b.preventDefault();if(9===b.keyCode&&a.dropdown.isOpen)return b.preventDefault()})):a.els.input.off("keydown.dropdownTrigger")}}(this));this.dropdown.onSelected(function(a){return function(b){if(!a.settings.multiple)return a.dropdown.isOpen=
!1}}(this));d("event:mouseenter",b).of(this.els.input).to(function(a){return function(){return a.state.hovered=!0}}(this));d("event:mouseleave",b).of(this.els.input).to(function(a){return function(){return a.state.hovered=!1}}(this));d("event:focus",b).of(this.els.input).to(function(a){return function(){a.state.focused=!0;if(a.state.disabled)return a.blur()}}(this));d("event:blur",b).of(this.els.input).to(function(a){return function(){return a.state.focused=!1}}(this))};t.prototype.validate=function(b){var a,
c;null==b&&(b=this.value);switch(!1){case !(this.settings.validWhenRegex&&g.regex(this.settings.validWhenRegex)):switch(!1){case !this.settings.multiple:return function(a){return function(){var c;if(0===b.length)return!1;c=b.filter(function(b){return a.settings.validWhenRegex.test(b)});return Infinity!==a.settings.validWhenChoseMin&&g.number(a.settings.validWhenChoseMin)?c.length>=a.settings.validWhenChoseMin:c.length===b.length}}(this)();default:return this.settings.validWhenRegex.test(b)}case !(this.settings.validWhenIsChoice&&
null!=(a=this.settings.choices)&&a.length):return a=this.settings.choices.filter(function(a){return a.value===b}),!!a.length;case !(this.settings.multiple&&-1>(c=this.settings.validWhenChoseMin)&&Infinity>c):return b.length>=this.settings.validWhenChoseMin;case !this.settings.multiple:return b.length;default:return!!b}};t.prototype.focus=function(){return this.els.input.raw.focus()};t.prototype.blur=function(){return this.els.input.raw.blur()};r.choice=t=function(){return this};t.prototype=Object.create(r.prototype);
t.prototype._templates={field:e.template(["div",{style:{position:"relative",display:"none",width:function(b){return b.state.width},boxSizing:"border-box",fontFamily:function(b){return b.settings.fontFamily},$visible:{$hasVisibleOptions:{display:"inline-block"}},$showError:{animation:"0.2s fieldErrorShake"}}}]),fieldInnerwrap:e.template(["div",{style:{position:"relative",boxSizing:"border-box",fontFamily:"inherit"}}]),label:e.template(["div",{style:{display:"none",marginBottom:"12px",fontFamily:"inherit",
fontSize:"13px",fontWeight:600,textAlign:"left",color:"#181818",cursor:"default",pointerEvents:"none",$hasLabel:{display:"block"},$focus:{color:"#ff9c00"},$showError:{color:"#cc4820"}}}]),choiceGroup:e.template(["div",{style:{marginBottom:function(b){return b.settings.spacing},userSelect:"none",fontSize:"0"}}]),choice:e.template(["div",{style:{position:"relative",display:"inline-block",width:function(b){return"calc((100% - "+b.settings.spacing*(b.settings.perGroup-1)+"px) / "+b.settings.perGroup+
")"},marginLeft:function(b){if(this.index)return"calc(100% - (100% - "+b.settings.spacing+"px))"},padding:"0 12px",borderRadius:"2px",backgroundColor:"white",fontFamily:"inherit",textAlign:"center",color:"#181818",boxSizing:"border-box",verticalAlign:"top",cursor:"pointer",$selected:{color:"#ff9c00"},$unavailable:{display:"none"}}},["div",{style:{position:"absolute",zIndex:2,top:"0",left:"0",width:"100%",height:"100%",borderWidth:"1px",borderStyle:"solid",borderColor:"#d3d3d3",borderRadius:"2px",
boxSizing:"border-box",$selected:{borderColor:"inherit",borderWidth:"2px"},$disabled:{backgroundColor:"#d3d3d3"}}}]]),choiceLabel:e.template(["div",{style:{position:"relative",display:"block",padding:"15px 0px",fontFamily:"inherit",fontSize:"14px",fontWeight:"500"}}]),choiceIcon:e.template(["div",{style:{position:"absolute",top:"50%",display:"block",fontSize:"20px",opacity:.16,transform:"translateY(-50%)"}}]),help:e.template(["div",{style:{marginTop:"10px",fontFamily:"inherit",fontSize:"11px",color:"#909090",
display:"none",$showError:{color:"#cc4820",display:"block"},$showHelp:{display:"block"}}}])};t.prototype._defaults={validWhenSelected:!1,validWhenIsChoice:!1,showSelectAll:!1,perGroup:7,spacing:8,choices:[]};t.prototype._construct=function(){var b;if(null==(b=this.settings.choices)||!b.length)throw Error("Choices were not provided for choice field '"+(this.settings.label||this.ID)+"'");this.settings.defaultValue||(this.value=this.settings.multiple?[]:null);this.lastSelected=null;this.visibleOptionsCount=
0;this.choices=this.settings.choices;this.settings.perGroup=Math.min(this.settings.perGroup,this.choices.length+(this.settings.multiple&&this.settings.showSelectAll?1:0))};t.prototype._createElements=function(){var b,a,c;a={relatedInstance:this,styleAfterInsert:!0};this.els.field=this._templates.field.spawn(this.settings.templates.field,a);this.els.fieldInnerwrap=this._templates.fieldInnerwrap.spawn(this.settings.templates.fieldInnerwrap,a).appendTo(this.els.field);this.els.label=this._templates.label.spawn(this.settings.templates.label,
a).prependTo(this.els.field);this.els.help=this._templates.help.spawn(this.settings.templates.help,a);this.settings.label&&(this.els.label.text(this.settings.label),this.els.field.state("hasLabel",!0));b=this.settings.choices;c=this.settings.perGroup;Array(Math.ceil(b.length/c)).fill().map(function(a,d){return b.slice(d*c,d*c+c)}).forEach(function(b){return function(c,d){var e;e=b._templates.choiceGroup.spawn(b.settings.templates.choiceGroup,a).appendTo(b.els.fieldInnerwrap);return c.forEach(function(c,
f){c.el=b._templates.choice.spawn(b.settings.templates.choice,a).appendTo(e);c.labelEl=b._templates.choiceLabel.spawn(b.settings.templates.choiceLabel,a).appendTo(c.el);c.icon&&(c.iconEl=b._templates.choiceIcon.spawn(b.settings.templates.choiceIcon,a).insertBefore(c.labelEl));c.el.index=f;c.el.totalIndex=f*d;c.el.prop("title",c.label);c.el.children[1].text(c.label);c.icon&&c.iconEl.append(c.label);c.visible=!0;c.selected=!1;return c.unavailable=!1})}}(this));this.els.help.appendTo(this.els.fieldInnerwrap);
this.els.fieldInnerwrap.raw._quickField=this};t.prototype._attachBindings=function(){var b;b={listenMethod:"on"};d("visible").of(this.state).to(function(a){return function(b){return a.els.field.state("visible",b)}}(this));d("hovered").of(this.state).to(function(a){return function(b){return a.els.field.state("hover",b)}}(this));d("filled").of(this.state).to(function(a){return function(b){return a.els.field.state("filled",b)}}(this));d("disabled").of(this.state).to(function(a){return function(b){return a.els.field.state("disabled",
b)}}(this));d("showError").of(this.state).to(function(a){return function(b){return a.els.field.state("showError",b)}}(this));d("showHelp").of(this.state).to(function(a){return function(b){return a.els.field.state("showHelp",b)}}(this));d("valid").of(this.state).to(function(a){return function(b){a.els.field.state("valid",b);return a.els.field.state("invalid",!b)}}(this));d("event:mouseenter",b).of(this.els.field).to(function(a){return function(){return a.state.hovered=!0}}(this));d("event:mouseleave",
b).of(this.els.field).to(function(a){return function(){return a.state.hovered=!1}}(this));d("width").of(this.state).to(function(a){return function(b){return a.els.field.style({width:b})}}(this));d("showError",{updateOnBind:!1}).of(this.state).to(function(a){return function(b,d){switch(!1){case !g.string(b):return a.els.help.text(b);case !g.string(d):return a.els.help.text(a.settings.help)}}}(this));d("visibleOptionsCount").of(this).to(function(a){return function(b){return a.els.field.state("hasVisibleOptions",
!!b)}}(this));d("value").of(this).to(function(a){return function(b){a.state.filled=!(null==b||!b.length);a.state.filled&&(a.state.interacted=!0);return a.state.valid=a.validate()}}(this));d("array:value",{updateOnBind:!1}).of(this).to(function(a){return function(){return a.emit("input")}}(this));d("lastSelected",{updateOnBind:!1,updateEvenIfSame:!0}).of(this).to(function(a){return function(b,d){if(a.settings.multiple){if(b.selected)return b.selected=!1,k.removeItem(a.value,b.value);b.selected=!0;
return a.value.push(b.value)}if(b!==d)return b.selected=!0,null!=d&&(d.selected=!1),a.value=b.value}}(this));this.choices.forEach(function(a){return function(b){var c;d("visible").of(b).to(function(a){return b.el.state("visible",a)}).and.to(function(b){return a.visibleOptionsCount+=b?1:-1});d("selected",{updateOnBind:!1}).of(b).to(function(a){return b.el.state("selected",a)});d("unavailable",{updateOnBind:!1}).of(b).to(function(a){return b.el.state("unavailable",a)}).and.to(function(){return a.lastSelected=
b}).condition(function(c){return c&&a.settings.multiple&&b.selected});d("event:click",{listenMethod:"on"}).of(b.el).to(function(){return a.lastSelected=b});if(null!=(c=b.conditions)&&c.length)return b.unavailable=!0,b.allFields=a.allFields,k.initConditions(b,b.conditions,function(){return b.unavailable=!k.validateConditions(b.conditions)})}}(this))};t.prototype.validate=function(b){var a;null==b&&(b=this.value);switch(!1){case "number"!==typeof this.settings.validWhenSelected:return(null!=b?b.length:
void 0)>=this.settings.validWhenSelected;case !this.settings.validWhenIsChoice:return a=this.choices.filter(function(a){return a.value===b}),!!a.length;default:return!(null==b||!b.length)}};p=function(b,a){this.options=b;this.field=a;this.isOpen=!1;this.settings=x.deep.clone.keys(this._defaults).filter(this._settingFilters)(this._defaults,this.field.settings.dropdownOptions);this.selected=this.settings.multiple?[]:null;this.currentHighlighted=this.lastSelected=null;this.visibleOptionsCount=0;this.visibleOptions=
[];this.els={};this._selectedCallback=Z;this._createElements();this._attachBindings();return this};p.prototype._templates={container:e.template(["div",{style:{position:"absolute",zIndex:10,overflow:"hidden",top:function(b){return"text"===b.field.type?this.parent.raw.style.height:"-7px"},left:function(){return 0>this.parent.rect.left-5?0:-5},display:"none",backgroundColor:"#f6f6f6",boxShadow:"0px 6px 10px "+k.hexToRGBA("000000",.32),borderWidth:"1px",borderStyle:"solid",borderColor:"#d1d1d1",borderRadius:"5px",
boxSizing:"border-box",padding:"4px 0",$isOpen:{$hasVisibleOptions:{display:"block"}}}}]),list:e.template(["div",{passStateToChildren:!1,style:{position:"relative",overflow:"scroll",overflowScrolling:"touch"}}]),option:e.template(["div",{style:{display:"none",fontSize:"0",color:"#000000",userSelect:"none",cursor:"pointer",$visible:{display:"block"},$hover:{color:"#ffffff",backgroundColor:"#4C96FF"}}},e.template(["div",{style:{display:"inline-block",verticalAlign:"top",width:"20px",lineHeight:"20px",
fontSize:"13px",textAlign:"center",color:"inherit",stroke:"currentColor",visibility:"hidden",$selected:{visibility:"visible"}}},z.checkmark]),e.template(["div",{style:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal",maxWidth:function(){return"calc(100% - "+this.prev.raw.style.width+")"},paddingRight:"10px",lineHeight:"20px",fontSize:"11px",fontFamily:T.fontFamily,color:"inherit",boxSizing:"border-box"}}])]),scrollIndicatorUp:e.template(["div",
{style:{position:"absolute",top:0,left:0,display:"none",width:"100%",height:"20px",backgroundColor:"#f6f6f6",color:"#000000",textAlign:"center",$visible:{display:"block"}}},["div",{style:{position:"absolute",top:"50%",left:0,right:0,width:"15px",height:"15px",display:"block",margin:"0 auto",transform:"translateY(-50%)"}},z.caretUp]]),scrollIndicatorDown:e.template(["div",{style:{position:"absolute",bottom:0,left:0,display:"none",width:"100%",height:"20px",backgroundColor:"#f6f6f6",color:"#000000",
textAlign:"center",$visible:{display:"block"}}},["div",{style:{position:"absolute",top:"50%",left:0,right:0,width:"15px",height:"15px",display:"block",margin:"0 auto",transform:"translateY(-50%)"}},z.caretDown]]),help:e.template(["div",{style:{display:"none",borderTop:"2px solid rgba(0,0,0,0.05)",padding:"4px 12px 1px",color:"rgba(0,0,0,0.5)",fontWeight:"500",fontSize:"11px",userSelect:"none",$showHelp:{display:"block"}}}])};p.prototype._defaults={maxHeight:300,multiple:!1,storeSelected:!0,lockScroll:!0,
help:"",templates:{}};p.prototype._settingFilters={maxHeight:function(b){return g.number(b)}};p.prototype._createElements=function(){var b;b={relatedInstance:this,styleAfterInsert:!0};this.els.container=this._templates.container.spawn(this.settings.templates.container,x({passStateToChildren:!1},b));this.els.list=this._templates.list.spawn(this.settings.templates.list,b).appendTo(this.els.container);this.els.help=this._templates.help.spawn(this.settings.templates.help,b).appendTo(this.els.container);
this.els.scrollIndicatorUp=this._templates.scrollIndicatorUp.spawn(this.settings.templates.scrollIndicatorUp,b).appendTo(this.els.container);this.els.scrollIndicatorDown=this._templates.scrollIndicatorDown.spawn(this.settings.templates.scrollIndicatorDown,b).appendTo(this.els.container);this.options.forEach(function(a){return function(c){c.el=a._templates.option.spawn({options:{props:{title:c.label}}},b).appendTo(a.els.list);c.el.children[1].text(c.label);c.visible=!0;c.selected=!1;return c.unavailable=
!1}}(this))};p.prototype._attachBindings=function(){d("help").of(this.settings).to("textContent").of(this.els.help.raw).and.to(function(b){return function(a){return b.els.help.state("showHelp",a)}}(this));d("visibleOptionsCount").of(this).to(function(b){return function(a){return b.els.container.state("hasVisibleOptions",!!a)}}(this));d("isOpen",{updateOnBind:!1}).of(this).to(function(b){return function(a){b.els.container.state("isOpen",a);a||(b.currentHighlighted=null);b.settings.lockScroll&&(a?k.lockScroll(b.els.list):
k.unlockScroll());if(a)return b.list_setMaxHeight(),b.list_scrollToSelected()}}(this));d("lastSelected",{updateOnBind:!1,updateEvenIfSame:!0}).of(this).to(function(b){return function(a,c){b.settings.storeSelected&&(b.settings.multiple?a.selected?(a.selected=!1,k.removeItem(b.selected,a)):(a.selected=!0,b.selected.push(a)):(a.selected=!0,a!==c&&null!=c&&(c.selected=!1),b.selected=a));return b._selectedCallback(a,c)}}(this));d("currentHighlighted").of(this).to(function(b){return function(a,b){b&&b.el.state("hover",
!1);if(a)return a.el.state("hover",!0)}}(this));d("focused").of(this.field.state).to(function(b){return function(a){return a?b.field.els.input.on("keydown.dropdownNav",function(a){if(b.isOpen)switch(a.keyCode){case 38:return a.preventDefault(),b.highlightPrev();case 40:return a.preventDefault(),b.highlightNext();case 13:return a.preventDefault(),b.selectHighlighted();case 27:return a.preventDefault(),b.isOpen=!1}}):b.field.els.input.off("keydown.dropdownNav")}}(this));d("scrollTop",{updateEvenIfSame:!0}).of(this.els.list.raw).to(function(b){return function(a){var c;
c=b.els.list.raw.scrollHeight-b.els.list.raw.clientHeight>a;b.els.scrollIndicatorUp.state("visible",0<a);return b.els.scrollIndicatorDown.state("visible",c)}}(this)).condition(function(b){return function(){return b.isOpen&&!b.settings.help&&b.els.list.raw.scrollHeight!==b.els.list.raw.clientHeight&&100<=b.els.list.raw.clientHeight}}(this)).updateOn("event:scroll").of(this.els.list.raw).updateOn("isOpen").of(this);this.els.scrollIndicatorUp.on("mouseenter",function(b){return function(){return b.list_startScrolling("up")}}(this));
this.els.scrollIndicatorUp.on("mouseleave",function(b){return function(){return b.list_stopScrolling()}}(this));this.els.scrollIndicatorDown.on("mouseenter",function(b){return function(){return b.list_startScrolling("down")}}(this));this.els.scrollIndicatorDown.on("mouseleave",function(b){return function(){return b.list_stopScrolling()}}(this));return this.options.forEach(function(b){return function(a,c){var e;a.index=c;d("visible").of(a).to(function(a){return b.visibleOptionsCount+=a?1:-1}).and.to(function(c){a.el.state("visible",
c);return c?(b.visibleOptions.push(a),b.visibleOptions.sort(function(a,b){return a.index-b.index})):k.removeItem(b.visibleOptions,a)});d("selected",{updateOnBind:!1}).of(a).to(function(b){return a.el.state("selected",b)});d("unavailable",{updateOnBind:!1}).of(a).to(function(b){return a.el.state("unavailable",b)}).and.to(function(){return b.lastSelected=a}).condition(function(c){return c&&b.settings.multiple&&a.selected});d("event:click",{listenMethod:"on"}).of(a.el).to(function(){return b.lastSelected=
a});d("event:mouseenter",{listenMethod:"on"}).of(a.el).to(function(){return b.currentHighlighted=a});if(null!=(e=a.conditions)&&e.length)return a.unavailable=!0,a.allFields=b.field.allFields,k.initConditions(a,a.conditions,function(){return a.unavailable=!k.validateConditions(a.conditions)})}}(this))};p.prototype.appendTo=function(b){return this.els.container.appendTo(b)};p.prototype.onSelected=function(b){return this._selectedCallback=b};p.prototype.findOption=function(b,a){return this.options.filter(function(c){return b===
(a?c.label:c.value)})[0]};p.prototype.getLabelOfOption=function(b){var a;return(null!=(a=this.options.filter(function(a){return b===a.value})[0])?a.label:void 0)||""};p.prototype.setOptionFromString=function(b,a){var c;if((c=this.findOption(b,a))&&c!==this.lastSelected&&(!this.settings.multiple||!k.includes(this.selected,c)))return this.lastSelected=c};p.prototype.highlightPrev=function(){var b;b=this.visibleOptions.indexOf(this.currentHighlighted);return 0<b?this.currentHighlighted=this.visibleOptions[b-
1]:this.currentHighlighted=this.visibleOptions[this.visibleOptions.length-1]};p.prototype.highlightNext=function(){var b;b=this.visibleOptions.indexOf(this.currentHighlighted);return b<this.visibleOptions.length-1?this.currentHighlighted=this.visibleOptions[b+1]:this.currentHighlighted=this.visibleOptions[0]};p.prototype.selectHighlighted=function(){if(this.currentHighlighted)return this.lastSelected=this.currentHighlighted};p.prototype.list_setMaxHeight=function(){var b,a,c,d;d=this.settings.maxHeight;
if(b=this.els.container.parentMatching(function(a){a=a.style("overflowY");return"hidden"===a||"scroll"===a}))c=this.els.container.rect,a=b.rect,b=c.top+this.settings.maxHeight-a.bottom,c.top>=a.bottom?console.warn("The dropdown for element '"+this.field.ID+"' cannot be displayed as it's hidden by the parent overflow"):0<b&&(c=c.height-this.els.list.rect.height,d=b-c);this.els.list.style("maxHeight",d);return this.els.list.style("minWidth",parseFloat(this.field.els.fieldInnerwrap.style("width"))+10)};
p.prototype.list_scrollToSelected=function(){var b,a;if(this.selected&&!this.settings.multiple)return b=this.selected.el.raw.offsetTop,a=this.selected.el.raw.clientHeight,this.els.list.raw.scrollTop=b-3*a};p.prototype.list_startScrolling=function(b){return this.scrollIntervalID=setInterval(function(a){return function(){return a.els.list.raw.scrollTop+="up"===b?-20:20}}(this),50)};p.prototype.list_stopScrolling=function(){return clearInterval(this.scrollIntervalID)};L="1#aA*^".split("");O=function(b,
a,c){this.pattern=b;this.placeholder=a;this.guide=c;this.optionalsOffset=this.minRequiredCount=0;this.lastValid=null;this.lastInput="";this.valid=!1;this.valueStrict=this.valueRaw=this.value="";this.prev={};this.literals=[];this.optionals=[];this.repeatables=[];this._normalizePattern();this.setValue("");return this};O.prototype._normalizePattern=function(){var b,a,c,d,e,g,l,h;g="";for(b=e=h=d=0;h<this.pattern.length;){l=this.pattern[h];switch(!1){case !a:a=!1;this.literals.push(h-e);g+=l;0===d&&b++;
break;case "\\"!==l:a=!0;e++;break;case "["!==l:c=!0;e++;break;case "]"!==l:c=!1;e++;break;case "+"!==l:e++;break;default:k.includes(L,l)?c?this.optionals.push(h-e):d++:(this.literals.push(h-e),0===d&&b++),"+"===this.pattern[h+1]&&this.repeatables.push(h-e),g+=l}h++}this.minRequiredCount=d;this.firstNonLiteral=b;return this.pattern=g};O.prototype.setValue=function(b){var a,c,d,e,g,l,h,p,r,t,z,y,x,C,A,B;c=k.getIndexOfFirstDiff(this.value,b);a=U(this.value,b);(g=1===b.length&&0===this.valueRaw.length?
!1:this.value.length>b.length)||(p=b.slice(c,c+a));y=z=t="";C=this.pattern.length;e=A=0;if(!(!a&&this.value||g&&k.includes(this.literals,c-this.optionalsOffset)&&c-this.optionalsOffset>this.firstNonLiteral)){for(;A<C;){B=A;x=this.pattern[A];d=b[e];l=k.includes(this.literals,A);h=k.includes(this.optionals,A);c=k.includes(this.repeatables,A);if(b&&!d&&!this.guide)break;switch(!1){case !l:t+=x;y+=x;x===d?k.includes(L,x)&&!g||a>=this.literals.length&&1<a&&this.valueRaw.length||e++:1===a&&b[e+1]===x&&
(e+=2);A++;break;case !k.includes(L,x):if(l=d&&J(d,x)){if("A"===x||"^"===x)d=d.toUpperCase();t+=d;z+=d;if(!h&&!c||r!==A)y+=d;r=b[e+1]&&J(b[e+1],x);e++;r&&c||A++;c&&!r&&k.includes(this.literals,A)&&b[e]!==this.pattern[A]&&e++}else 1!==a||!J(b[e+1],x)||g?(A++,!h&&this.guide&&(t+=this.placeholder,y+=this.placeholder)):h&&e++,h||e++;break;default:debugger}r=B}this.prev.value=this.value;this.prev.valueRaw=this.valueRaw;this.prev.valueStrict=this.valueStrict;this.value=t;this.valueRaw=z;this.valueStrict=
y;p&&(this.lastInput=p);this.optionalsOffset=U(t,y);this.valid=this.validate(b,!0)}};O.prototype.validate=function(b,a){var c,d,e,l,p,h,r,t;if(!g.string(b)||b.length<this.minRequiredCount)return!1;r=this.pattern.length;for(d=t=0;t<r;)switch(h=this.pattern[t],c=b[d],e=k.includes(this.literals,t),l=k.includes(this.optionals,t),p=k.includes(this.repeatables,t),!1){case !e:t++;h===c&&null!=b[d+1]&&d++;break;case !k.includes(L,h):if(c=c&&J(c,h))l=b[d+1]&&J(b[d+1],h),d++,l&&p||t++;else if(l)t++;else return a&&
(this.lastValid=0>d-1?null:d-1),!1}a&&(this.lastValid=d);return!0};O.prototype.normalizeCursorPos=function(b,a){var c,d,e,g,l,h;e=a>b;b<=this.firstNonLiteral&&(c=1<=this.firstNonLiteral-b&&!e||1===this.firstNonLiteral?1:0,b=this.firstNonLiteral+c);g=0;l=this.value.slice(0,b);h=this.valueStrict.slice(0,b);c=k.getIndexOfFirstDiff(this.value,this.prev.value);for(d=0;d<b;)l[d]!==h[d-g]&&g++,d++;if(e){if(b===this.firstNonLiteral)return b;if(k.includes(this.literals,b-1)||this.value[b-1]===this.placeholder)return b-
(0===g?1:0)}else{if(null===c)return k.includes(this.literals,b-g-1)&&h[b-g-1]===this.lastInput?b:Math.max(b-1,this.firstNonLiteral);if(k.includes(this.repeatables,b-g)||k.includes(this.repeatables,c-g))return b;if(k.includes(this.literals,b-g))return b+(0===g?1:0);if(k.includes(this.literals,c-1)&&c===b)return b+1}return b};J=function(b,a){switch(a){case "1":return X.test(b);case "#":return N.test(b);case "a":case "A":return F.test(b);case "*":case "^":return Q.test(b);default:return!1}};G.SVG=z;
G.version="1.0.4";return null!=("undefined"!==typeof module&&null!==module?module.exports:void 0)?module.exports=G:"function"===typeof define&&define.amd?define(["quickfield"],function(){return G}):this.Field=G}()}})(this)();
